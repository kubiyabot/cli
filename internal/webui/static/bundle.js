var ye,F,Je,Kt,ee,je,Ke,Ge,Ze,Le,Se,Ce,Ye,ie={},Xe=[],Gt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,le=Array.isArray;function X(t,r){for(var n in r)t[n]=r[n];return t}function Ie(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function ne(t,r,n){var a,o,s,i={};for(s in r)s=="key"?a=r[s]:s=="ref"?o=r[s]:i[s]=r[s];if(arguments.length>2&&(i.children=arguments.length>3?ye.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(s in t.defaultProps)i[s]===void 0&&(i[s]=t.defaultProps[s]);return ge(t,i,a,o,null)}function ge(t,r,n,a,o){var s={type:t,props:r,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++Je,__i:-1,__u:0};return o==null&&F.vnode!=null&&F.vnode(s),s}function A(t){return t.children}function Y(t,r){this.props=t,this.context=r}function re(t,r){if(r==null)return t.__?re(t.__,t.__i+1):null;for(var n;r<t.__k.length;r++)if((n=t.__k[r])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?re(t):null}function Qe(t){var r,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if((n=t.__k[r])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Qe(t)}}function Ee(t){(!t.__d&&(t.__d=!0)&&ee.push(t)&&!fe.__r++||je!=F.debounceRendering)&&((je=F.debounceRendering)||Ke)(fe)}function fe(){for(var t,r,n,a,o,s,i,c=1;ee.length;)ee.length>c&&ee.sort(Ge),t=ee.shift(),c=ee.length,t.__d&&(n=void 0,a=void 0,o=(a=(r=t).__v).__e,s=[],i=[],r.__P&&((n=X({},a)).__v=a.__v+1,F.vnode&&F.vnode(n),Re(r.__P,n,a,r.__n,r.__P.namespaceURI,32&a.__u?[o]:null,s,o??re(a),!!(32&a.__u),i),n.__v=a.__v,n.__.__k[n.__i]=n,rt(s,n,i),a.__e=a.__=null,n.__e!=o&&Qe(n)));fe.__r=0}function et(t,r,n,a,o,s,i,c,l,u,p){var d,h,S,C,R,E,v,g=a&&a.__k||Xe,I=r.length;for(l=Zt(n,r,g,l,I),d=0;d<I;d++)(S=n.__k[d])!=null&&(h=S.__i==-1?ie:g[S.__i]||ie,S.__i=d,E=Re(t,S,h,o,s,i,c,l,u,p),C=S.__e,S.ref&&h.ref!=S.ref&&(h.ref&&ze(h.ref,null,S),p.push(S.ref,S.__c||C,S)),R==null&&C!=null&&(R=C),(v=!!(4&S.__u))||h.__k===S.__k?l=tt(S,l,t,v):typeof S.type=="function"&&E!==void 0?l=E:C&&(l=C.nextSibling),S.__u&=-7);return n.__e=R,l}function Zt(t,r,n,a,o){var s,i,c,l,u,p=n.length,d=p,h=0;for(t.__k=new Array(o),s=0;s<o;s++)(i=r[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?i=t.__k[s]=ge(null,i,null,null,null):le(i)?i=t.__k[s]=ge(A,{children:i},null,null,null):i.constructor==null&&i.__b>0?i=t.__k[s]=ge(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):t.__k[s]=i,l=s+h,i.__=t,i.__b=t.__b+1,(u=i.__i=Yt(i,n,l,d))!=-1&&(d--,(c=n[u])&&(c.__u|=2)),c==null||c.__v==null?(u==-1&&(o>p?h--:o<p&&h++),typeof i.type!="function"&&(i.__u|=4)):u!=l&&(u==l-1?h--:u==l+1?h++:(u>l?h--:h++,i.__u|=4))):t.__k[s]=null;if(d)for(s=0;s<p;s++)(c=n[s])!=null&&!(2&c.__u)&&(c.__e==a&&(a=re(c)),at(c,c));return a}function tt(t,r,n,a){var o,s;if(typeof t.type=="function"){for(o=t.__k,s=0;o&&s<o.length;s++)o[s]&&(o[s].__=t,r=tt(o[s],r,n,a));return r}t.__e!=r&&(a&&(r&&t.type&&!r.parentNode&&(r=re(t)),n.insertBefore(t.__e,r||null)),r=t.__e);do r=r&&r.nextSibling;while(r!=null&&r.nodeType==8);return r}function de(t,r){return r=r||[],t==null||typeof t=="boolean"||(le(t)?t.some(function(n){de(n,r)}):r.push(t)),r}function Yt(t,r,n,a){var o,s,i,c=t.key,l=t.type,u=r[n],p=u!=null&&(2&u.__u)==0;if(u===null&&c==null||p&&c==u.key&&l==u.type)return n;if(a>(p?1:0)){for(o=n-1,s=n+1;o>=0||s<r.length;)if((u=r[i=o>=0?o--:s++])!=null&&!(2&u.__u)&&c==u.key&&l==u.type)return i}return-1}function Ue(t,r,n){r[0]=="-"?t.setProperty(r,n??""):t[r]=n==null?"":typeof n!="number"||Gt.test(r)?n:n+"px"}function ve(t,r,n,a,o){var s,i;e:if(r=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof a=="string"&&(t.style.cssText=a=""),a)for(r in a)n&&r in n||Ue(t.style,r,"");if(n)for(r in n)a&&n[r]==a[r]||Ue(t.style,r,n[r])}else if(r[0]=="o"&&r[1]=="n")s=r!=(r=r.replace(Ze,"$1")),i=r.toLowerCase(),r=i in t||r=="onFocusOut"||r=="onFocusIn"?i.slice(2):r.slice(2),t.l||(t.l={}),t.l[r+s]=n,n?a?n.u=a.u:(n.u=Le,t.addEventListener(r,s?Ce:Se,s)):t.removeEventListener(r,s?Ce:Se,s);else{if(o=="http://www.w3.org/2000/svg")r=r.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(r!="width"&&r!="height"&&r!="href"&&r!="list"&&r!="form"&&r!="tabIndex"&&r!="download"&&r!="rowSpan"&&r!="colSpan"&&r!="role"&&r!="popover"&&r in t)try{t[r]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&r[4]!="-"?t.removeAttribute(r):t.setAttribute(r,r=="popover"&&n==1?"":n))}}function qe(t){return function(r){if(this.l){var n=this.l[r.type+t];if(r.t==null)r.t=Le++;else if(r.t<n.u)return;return n(F.event?F.event(r):r)}}}function Re(t,r,n,a,o,s,i,c,l,u){var p,d,h,S,C,R,E,v,g,I,P,B,W,G,T,f,b,y=r.type;if(r.constructor!=null)return null;128&n.__u&&(l=!!(32&n.__u),s=[c=r.__e=n.__e]),(p=F.__b)&&p(r);e:if(typeof y=="function")try{if(v=r.props,g="prototype"in y&&y.prototype.render,I=(p=y.contextType)&&a[p.__c],P=p?I?I.props.value:p.__:a,n.__c?E=(d=r.__c=n.__c).__=d.__E:(g?r.__c=d=new y(v,P):(r.__c=d=new Y(v,P),d.constructor=y,d.render=Qt),I&&I.sub(d),d.state||(d.state={}),d.__n=a,h=d.__d=!0,d.__h=[],d._sb=[]),g&&d.__s==null&&(d.__s=d.state),g&&y.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=X({},d.__s)),X(d.__s,y.getDerivedStateFromProps(v,d.__s))),S=d.props,C=d.state,d.__v=r,h)g&&y.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),g&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(g&&y.getDerivedStateFromProps==null&&v!==S&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(v,P),r.__v==n.__v||!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(v,d.__s,P)===!1){for(r.__v!=n.__v&&(d.props=v,d.state=d.__s,d.__d=!1),r.__e=n.__e,r.__k=n.__k,r.__k.some(function(M){M&&(M.__=r)}),B=0;B<d._sb.length;B++)d.__h.push(d._sb[B]);d._sb=[],d.__h.length&&i.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(v,d.__s,P),g&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(S,C,R)})}if(d.context=P,d.props=v,d.__P=t,d.__e=!1,W=F.__r,G=0,g){for(d.state=d.__s,d.__d=!1,W&&W(r),p=d.render(d.props,d.state,d.context),T=0;T<d._sb.length;T++)d.__h.push(d._sb[T]);d._sb=[]}else do d.__d=!1,W&&W(r),p=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++G<25);d.state=d.__s,d.getChildContext!=null&&(a=X(X({},a),d.getChildContext())),g&&!h&&d.getSnapshotBeforeUpdate!=null&&(R=d.getSnapshotBeforeUpdate(S,C)),f=p,p!=null&&p.type===A&&p.key==null&&(f=nt(p.props.children)),c=et(t,le(f)?f:[f],r,n,a,o,s,i,c,l,u),d.base=r.__e,r.__u&=-161,d.__h.length&&i.push(d),E&&(d.__E=d.__=null)}catch(M){if(r.__v=null,l||s!=null)if(M.then){for(r.__u|=l?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;s[s.indexOf(c)]=null,r.__e=c}else{for(b=s.length;b--;)Ie(s[b]);Te(r)}else r.__e=n.__e,r.__k=n.__k,M.then||Te(r);F.__e(M,r,n)}else s==null&&r.__v==n.__v?(r.__k=n.__k,r.__e=n.__e):c=r.__e=Xt(n.__e,r,n,a,o,s,i,l,u);return(p=F.diffed)&&p(r),128&r.__u?void 0:c}function Te(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Te)}function rt(t,r,n){for(var a=0;a<n.length;a++)ze(n[a],n[++a],n[++a]);F.__c&&F.__c(r,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(s){s.call(o)})}catch(s){F.__e(s,o.__v)}})}function nt(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:le(t)?t.map(nt):X({},t)}function Xt(t,r,n,a,o,s,i,c,l){var u,p,d,h,S,C,R,E=n.props||ie,v=r.props,g=r.type;if(g=="svg"?o="http://www.w3.org/2000/svg":g=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),s!=null){for(u=0;u<s.length;u++)if((S=s[u])&&"setAttribute"in S==!!g&&(g?S.localName==g:S.nodeType==3)){t=S,s[u]=null;break}}if(t==null){if(g==null)return document.createTextNode(v);t=document.createElementNS(o,g,v.is&&v),c&&(F.__m&&F.__m(r,s),c=!1),s=null}if(g==null)E===v||c&&t.data==v||(t.data=v);else{if(s=s&&ye.call(t.childNodes),!c&&s!=null)for(E={},u=0;u<t.attributes.length;u++)E[(S=t.attributes[u]).name]=S.value;for(u in E)if(S=E[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=S;else if(!(u in v)){if(u=="value"&&"defaultValue"in v||u=="checked"&&"defaultChecked"in v)continue;ve(t,u,null,S,o)}}for(u in v)S=v[u],u=="children"?h=S:u=="dangerouslySetInnerHTML"?p=S:u=="value"?C=S:u=="checked"?R=S:c&&typeof S!="function"||E[u]===S||ve(t,u,S,E[u],o);if(p)c||d&&(p.__html==d.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),r.__k=[];else if(d&&(t.innerHTML=""),et(r.type=="template"?t.content:t,le(h)?h:[h],r,n,a,g=="foreignObject"?"http://www.w3.org/1999/xhtml":o,s,i,s?s[0]:n.__k&&re(n,0),c,l),s!=null)for(u=s.length;u--;)Ie(s[u]);c||(u="value",g=="progress"&&C==null?t.removeAttribute("value"):C!=null&&(C!==t[u]||g=="progress"&&!C||g=="option"&&C!=E[u])&&ve(t,u,C,E[u],o),u="checked",R!=null&&R!=t[u]&&ve(t,u,R,E[u],o))}return t}function ze(t,r,n){try{if(typeof t=="function"){var a=typeof t.__u=="function";a&&t.__u(),a&&r==null||(t.__u=t(r))}else t.current=r}catch(o){F.__e(o,n)}}function at(t,r,n){var a,o;if(F.unmount&&F.unmount(t),(a=t.ref)&&(a.current&&a.current!=t.__e||ze(a,null,r)),(a=t.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(s){F.__e(s,r)}a.base=a.__P=null}if(a=t.__k)for(o=0;o<a.length;o++)a[o]&&at(a[o],r,n||typeof t.type!="function");n||Ie(t.__e),t.__c=t.__=t.__e=void 0}function Qt(t,r,n){return this.constructor(t,n)}function Pe(t,r,n){var a,o,s,i;r==document&&(r=document.documentElement),F.__&&F.__(t,r),o=(a=typeof n=="function")?null:n&&n.__k||r.__k,s=[],i=[],Re(r,t=(!a&&n||r).__k=ne(A,null,[t]),o||ie,ie,r.namespaceURI,!a&&n?[n]:o?null:r.firstChild?ye.call(r.childNodes):null,s,!a&&n?n:o?o.__e:r.firstChild,a,i),rt(s,t,i)}function ae(t){function r(n){var a,o;return this.getChildContext||(a=new Set,(o={})[r.__c]=this,this.getChildContext=function(){return o},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&a.forEach(function(i){i.__e=!0,Ee(i)})},this.sub=function(s){a.add(s);var i=s.componentWillUnmount;s.componentWillUnmount=function(){a&&a.delete(s),i&&i.call(s)}}),n.children}return r.__c="__cC"+Ye++,r.__=t,r.Provider=r.__l=(r.Consumer=function(n,a){return n.children(a)}).contextType=r,r}ye=Xe.slice,F={__e:function(t,r,n,a){for(var o,s,i;r=r.__;)if((o=r.__c)&&!o.__)try{if((s=o.constructor)&&s.getDerivedStateFromError!=null&&(o.setState(s.getDerivedStateFromError(t)),i=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,a||{}),i=o.__d),i)return o.__E=o}catch(c){t=c}throw t}},Je=0,Kt=function(t){return t!=null&&t.constructor==null},Y.prototype.setState=function(t,r){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=X({},this.state),typeof t=="function"&&(t=t(X({},n),this.props)),t&&X(n,t),t!=null&&this.__v&&(r&&this._sb.push(r),Ee(this))},Y.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ee(this))},Y.prototype.render=A,ee=[],Ke=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ge=function(t,r){return t.__v.__b-r.__v.__b},fe.__r=0,Ze=/(PointerCapture)$|Capture$/i,Le=0,Se=qe(!1),Ce=qe(!0),Ye=0;var er=0,Nr=Array.isArray;function e(t,r,n,a,o,s){r||(r={});var i,c,l=r;if("ref"in l)for(c in l={},r)c=="ref"?i=r[c]:l[c]=r[c];var u={type:t,props:l,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--er,__i:-1,__u:0,__source:o,__self:s};if(typeof t=="function"&&(i=t.defaultProps))for(c in i)l[c]===void 0&&(l[c]=i[c]);return F.vnode&&F.vnode(u),u}var tr=[{id:"overview",label:"Overview",icon:"chart"},{id:"workers",label:"Workers",icon:"cpu"},{id:"playground",label:"Playground",icon:"play"},{id:"proxy",label:"LLM Proxy",icon:"route"},{id:"models",label:"Models",icon:"brain"},{id:"environment",label:"Environment",icon:"settings"},{id:"doctor",label:"Doctor",icon:"health"},{id:"control-plane",label:"Control Plane",icon:"cloud"},{id:"diagnostics",label:"Logs",icon:"terminal"},{id:"sessions",label:"Sessions",icon:"chat"}];function rr({type:t}){return{chart:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("path",{d:"M3 3v18h18"}),e("path",{d:"M18 17V9"}),e("path",{d:"M13 17V5"}),e("path",{d:"M8 17v-3"})]}),cpu:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("rect",{x:"9",y:"9",width:"6",height:"6"}),e("path",{d:"M9 1v3M15 1v3M9 20v3M15 20v3M20 9h3M20 14h3M1 9h3M1 14h3"})]}),play:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("polygon",{points:"5 3 19 12 5 21 5 3"})}),route:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("circle",{cx:"6",cy:"19",r:"3"}),e("path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}),e("circle",{cx:"18",cy:"5",r:"3"})]}),brain:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"}),e("path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"}),e("path",{d:"M12 5v13"})]}),settings:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),health:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})}),cloud:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("path",{d:"M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"})}),terminal:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("polyline",{points:"4 17 10 11 4 5"}),e("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),chat:e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}[t]||null}function nr(t,r){if(!t)return"";let n={darwin:"macOS",linux:"Linux",windows:"Windows"},a={amd64:"x64",arm64:"ARM64",386:"x86"},o=n[t]||t,s=r?a[r]||r:"";return s?`${o} ${s}`:o}function ot({children:t,currentPage:r,onNavigate:n,connected:a,queueId:o,controlPlane:s,config:i}){let l=s?s.connected?{class:"connected",text:"Connected"}:s.auth_status==="expired"?{class:"disconnected",text:"Auth Error"}:{class:"disconnected",text:"Disconnected"}:{class:"connecting",text:"Checking..."},u=nr(i?.os,i?.arch);return e("div",{class:"layout",children:[e("header",{class:"header",children:[e("div",{class:"header-title",children:[e("div",{class:"header-brand",children:[e("div",{class:"header-logo-text",children:[e("span",{class:"logo-kubiya",children:"KUBIYA"}),e("span",{class:"logo-dot",children:"."}),e("span",{class:"logo-ai",children:"AI"})]}),e("div",{class:"header-brand-divider"}),e("div",{class:"header-brand-text",children:[e("h1",{children:"Worker Pool Server"}),e("div",{class:"header-brand-meta",children:[i?.version&&e("span",{class:"header-version",children:["v",i.version]}),i?.build_commit&&i.build_commit!=="unknown"&&e("span",{class:"header-build",children:["build ",i.build_commit.slice(0,7)]}),u&&e("span",{class:"header-os",children:u})]})]})]}),o&&e("div",{class:"header-queue-badge",children:[e("span",{class:"header-queue-icon",children:e("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e("span",{class:"header-queue-text",children:[o.slice(0,8),"..."]})]})]}),e("div",{class:"header-status",children:e("div",{class:"status-group",children:[e("div",{class:"status-item",children:[e("span",{class:"status-label",children:"SSE"}),e("span",{class:`status-dot ${a?"connected":"connecting"}`})]}),e("div",{class:"status-divider"}),e("div",{class:"status-item",children:[e("span",{class:"status-label",children:"Control Plane"}),e("span",{class:`status-dot ${l.class}`}),e("span",{class:"status-text",children:l.text}),s?.latency_ms&&s.connected&&e("span",{class:"status-latency",children:[s.latency_ms,"ms"]})]})]})})]}),e("nav",{class:"nav",children:e("ul",{class:"nav-tabs",children:tr.map(p=>e("li",{class:`nav-tab ${r===p.id?"active":""}`,onClick:()=>n(p.id),children:[e("span",{class:"nav-tab-icon",children:e(rr,{type:p.icon})}),e("span",{class:"nav-tab-label",children:p.label})]},p.id))})}),e("main",{class:"content",children:t})]})}function st(t){if(t!==void 0)return typeof t=="number"?`${t}px`:t}function z({variant:t="text",width:r,height:n,animation:a="pulse",className:o=""}){let s=t==="circular"?"40px":"100%",i=t==="text"?"1em":t==="circular"?"40px":"100px",c={width:st(r)||s,height:st(n)||i};t==="circular"&&(c.borderRadius="50%");let l=["skeleton",`skeleton-${t}`,a!=="none"&&`skeleton-${a}`,o].filter(Boolean).join(" ");return e("div",{class:l,style:c,"aria-hidden":"true",role:"presentation"})}function Me({state:t,isLoading:r}){let{overview:n,activity:a,controlPlane:o}=t;return r||!n&&!o?e(or,{}):e(A,{children:[e("div",{class:"stats-grid",children:[e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Active Workers"}),e("div",{class:"stat-value success",children:n?.active_workers??0})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Tasks Processed"}),e("div",{class:"stat-value",children:n?.tasks_processed??0})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Tasks Active"}),e("div",{class:"stat-value",children:n?.tasks_active??0})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Error Rate"}),e("div",{class:`stat-value ${(n?.error_rate??0)>5?"error":""}`,children:[(n?.error_rate??0).toFixed(1),"%"]})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Uptime"}),e("div",{class:"stat-value",children:n?.uptime_formatted??"0s"})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Control Plane"}),e("div",{class:`stat-value ${o?.connected?"success":"error"}`,children:o?.connected?"Connected":"Disconnected"})]})]}),e("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Connection Status"})}),e("div",{style:{display:"flex",gap:"2rem"},children:[e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"Control Plane"}),e("span",{class:`badge ${o?.connected?"badge-success":"badge-error"}`,children:o?.connected?"Connected":"Disconnected"}),o?.latency_ms&&e("span",{style:{marginLeft:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[o.latency_ms,"ms"]})]}),e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"Auth Status"}),e("span",{class:`badge ${o?.auth_status==="valid"?"badge-success":"badge-warning"}`,children:o?.auth_status??"Unknown"})]}),n?.litellm_proxy_ok!==void 0&&e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"LiteLLM Proxy"}),e("span",{class:`badge ${n.litellm_proxy_ok?"badge-success":"badge-error"}`,children:n.litellm_proxy_ok?"Running":"Stopped"})]})]})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Workers Summary"})}),e("div",{style:{display:"flex",gap:"2rem"},children:[e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"Total"}),e("div",{style:{fontSize:"1.25rem",fontWeight:600},children:n?.total_workers??0})]}),e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"Active"}),e("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--success)"},children:n?.active_workers??0})]}),e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"Idle"}),e("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--text-muted)"},children:n?.idle_workers??0})]})]})]})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Recent Activity"})}),e("div",{class:"activity-feed",children:a.length===0?e("div",{class:"empty-state",children:e("div",{style:{color:"var(--text-muted)"},children:"No recent activity"})}):a.slice(0,10).map((s,i)=>e(ar,{activity:s},i))})]})]})}function ar({activity:t}){let r=()=>{switch(t.type){case"task_completed":case"worker_started":return"success";case"task_failed":return"error";default:return"info"}},n=()=>{switch(t.type){case"task_completed":return"\u2713";case"task_failed":return"\u2717";case"worker_started":return"\u25B6";case"session_started":return"\u{1F4AC}";default:return"\u2022"}},a=o=>new Date(o).toLocaleTimeString();return e("div",{class:"activity-item",children:[e("div",{class:`activity-icon ${r()}`,children:n()}),e("div",{class:"activity-content",children:[e("div",{class:"activity-text",children:t.description}),e("div",{class:"activity-time",children:a(t.timestamp)})]})]})}function or(){return e(A,{children:[e("div",{class:"stats-grid",children:[1,2,3,4,5,6].map(t=>e("div",{class:"stat-card",children:[e(z,{variant:"text",width:"60%",height:"0.75rem"}),e(z,{variant:"text",width:"40%",height:"2rem"})]},t))}),e("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e("div",{class:"card",children:[e("div",{class:"card-header",children:e(z,{variant:"text",width:140,height:"1rem"})}),e("div",{style:{display:"flex",gap:"2rem"},children:[1,2,3].map(t=>e("div",{children:[e(z,{variant:"text",width:80,height:"0.75rem"}),e(z,{variant:"rectangular",width:70,height:22})]},t))})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e(z,{variant:"text",width:140,height:"1rem"})}),e("div",{style:{display:"flex",gap:"2rem"},children:[1,2,3].map(t=>e("div",{children:[e(z,{variant:"text",width:50,height:"0.75rem"}),e(z,{variant:"text",width:30,height:"1.5rem"})]},t))})]})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e(z,{variant:"text",width:130,height:"1rem"})}),e("div",{class:"activity-feed",children:[1,2,3,4,5].map(t=>e("div",{class:"activity-item",children:[e(z,{variant:"circular",width:28,height:28}),e("div",{class:"activity-content",style:{flex:1},children:[e(z,{variant:"text",width:"70%",height:"0.875rem"}),e(z,{variant:"text",width:60,height:"0.75rem"})]})]},t))})]})]})}var oe,q,Ae,it,ce=0,gt=[],K=F,lt=K.__b,dt=K.__r,ct=K.diffed,ut=K.__c,pt=K.unmount,mt=K.__;function _e(t,r){K.__h&&K.__h(q,t,ce||r),ce=0;var n=q.__H||(q.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function x(t){return ce=1,ft(ht,t)}function ft(t,r,n){var a=_e(oe++,2);if(a.t=t,!a.__c&&(a.__=[n?n(r):ht(void 0,r),function(c){var l=a.__N?a.__N[0]:a.__[0],u=a.t(l,c);l!==u&&(a.__N=[u,a.__[1]],a.__c.setState({}))}],a.__c=q,!q.__f)){var o=function(c,l,u){if(!a.__c.__H)return!0;var p=a.__c.__H.__.filter(function(h){return!!h.__c});if(p.every(function(h){return!h.__N}))return!s||s.call(this,c,l,u);var d=a.__c.props!==c;return p.forEach(function(h){if(h.__N){var S=h.__[0];h.__=h.__N,h.__N=void 0,S!==h.__[0]&&(d=!0)}}),s&&s.call(this,c,l,u)||d};q.__f=!0;var s=q.shouldComponentUpdate,i=q.componentWillUpdate;q.componentWillUpdate=function(c,l,u){if(this.__e){var p=s;s=void 0,o(c,l,u),s=p}i&&i.call(this,c,l,u)},q.shouldComponentUpdate=o}return a.__N||a.__}function N(t,r){var n=_e(oe++,3);!K.__s&&yt(n.__H,r)&&(n.__=t,n.u=r,q.__H.__h.push(n))}function V(t){return ce=5,te(function(){return{current:t}},[])}function te(t,r){var n=_e(oe++,7);return yt(n.__H,r)&&(n.__=t(),n.__H=r,n.__h=t),n.__}function O(t,r){return ce=8,te(function(){return t},r)}function ue(t){var r=q.context[t.__c],n=_e(oe++,9);return n.c=t,r?(n.__==null&&(n.__=!0,r.sub(q)),r.props.value):t.__}function sr(){for(var t;t=gt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(he),t.__H.__h.forEach(We),t.__H.__h=[]}catch(r){t.__H.__h=[],K.__e(r,t.__v)}}K.__b=function(t){q=null,lt&&lt(t)},K.__=function(t,r){t&&r.__k&&r.__k.__m&&(t.__m=r.__k.__m),mt&&mt(t,r)},K.__r=function(t){dt&&dt(t),oe=0;var r=(q=t.__c).__H;r&&(Ae===q?(r.__h=[],q.__h=[],r.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(r.__h.forEach(he),r.__h.forEach(We),r.__h=[],oe=0)),Ae=q},K.diffed=function(t){ct&&ct(t);var r=t.__c;r&&r.__H&&(r.__H.__h.length&&(gt.push(r)!==1&&it===K.requestAnimationFrame||((it=K.requestAnimationFrame)||ir)(sr)),r.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Ae=q=null},K.__c=function(t,r){r.some(function(n){try{n.__h.forEach(he),n.__h=n.__h.filter(function(a){return!a.__||We(a)})}catch(a){r.some(function(o){o.__h&&(o.__h=[])}),r=[],K.__e(a,n.__v)}}),ut&&ut(t,r)},K.unmount=function(t){pt&&pt(t);var r,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(a){try{he(a)}catch(o){r=o}}),n.__H=void 0,r&&K.__e(r,n.__v))};var vt=typeof requestAnimationFrame=="function";function ir(t){var r,n=function(){clearTimeout(a),vt&&cancelAnimationFrame(r),setTimeout(t)},a=setTimeout(n,35);vt&&(r=requestAnimationFrame(n))}function he(t){var r=q,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),q=r}function We(t){var r=q;t.__c=t.__(),q=r}function yt(t,r){return!t||t.length!==r.length||r.some(function(n,a){return n!==t[a]})}function ht(t,r){return typeof r=="function"?r(t):r}function dr(t,r){for(var n in r)t[n]=r[n];return t}function Be(t,r){for(var n in t)if(n!=="__source"&&!(n in r))return!0;for(var a in r)if(a!=="__source"&&t[a]!==r[a])return!0;return!1}function _t(t,r){this.props=t,this.context=r}function xe(t,r){function n(o){var s=this.props.ref,i=s==o.ref;return!i&&s&&(s.call?s(null):s.current=null),r?!r(this.props,o)||!i:Be(this.props,o)}function a(o){return this.shouldComponentUpdate=n,ne(t,o)}return a.displayName="Memo("+(t.displayName||t.name)+")",a.prototype.isReactComponent=!0,a.__f=!0,a.type=t,a}(_t.prototype=new Y).isPureReactComponent=!0,_t.prototype.shouldComponentUpdate=function(t,r){return Be(this.props,t)||Be(this.state,r)};var bt=F.__b;F.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),bt&&bt(t)};var dn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var cr=F.__e;F.__e=function(t,r,n,a){if(t.then){for(var o,s=r;s=s.__;)if((o=s.__c)&&o.__c)return r.__e==null&&(r.__e=n.__e,r.__k=n.__k),o.__c(t,r)}cr(t,r,n,a)};var xt=F.unmount;function Tt(t,r,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(a){typeof a.__c=="function"&&a.__c()}),t.__c.__H=null),(t=dr({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=r),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(a){return Tt(a,r,n)})),t}function Lt(t,r,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(a){return Lt(a,r,n)}),t.__c&&t.__c.__P===r&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Fe(){this.__u=0,this.o=null,this.__b=null}function It(t){var r=t.__.__c;return r&&r.__a&&r.__a(t)}function be(){this.i=null,this.l=null}F.unmount=function(t){var r=t.__c;r&&r.__R&&r.__R(),r&&32&t.__u&&(t.type=null),xt&&xt(t)},(Fe.prototype=new Y).__c=function(t,r){var n=r.__c,a=this;a.o==null&&(a.o=[]),a.o.push(n);var o=It(a.__v),s=!1,i=function(){s||(s=!0,n.__R=null,o?o(c):c())};n.__R=i;var c=function(){if(!--a.__u){if(a.state.__a){var l=a.state.__a;a.__v.__k[0]=Lt(l,l.__c.__P,l.__c.__O)}var u;for(a.setState({__a:a.__b=null});u=a.o.pop();)u.forceUpdate()}};a.__u++||32&r.__u||a.setState({__a:a.__b=a.__v.__k[0]}),t.then(i,i)},Fe.prototype.componentWillUnmount=function(){this.o=[]},Fe.prototype.render=function(t,r){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),a=this.__v.__k[0].__c;this.__v.__k[0]=Tt(this.__b,n,a.__O=a.__P)}this.__b=null}var o=r.__a&&ne(A,null,t.fallback);return o&&(o.__u&=-33),[ne(A,null,r.__a?null:t.children),o]};var wt=function(t,r,n){if(++n[1]===n[0]&&t.l.delete(r),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(n=t.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.i=n=n[2]}};(be.prototype=new Y).__a=function(t){var r=this,n=It(r.__v),a=r.l.get(t);return a[0]++,function(o){var s=function(){r.props.revealOrder?(a.push(o),wt(r,t,a)):o()};n?n(s):s()}},be.prototype.render=function(t){this.i=null,this.l=new Map;var r=de(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&r.reverse();for(var n=r.length;n--;)this.l.set(r[n],this.i=[1,0,this.i]);return t.children},be.prototype.componentDidUpdate=be.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(r,n){wt(t,n,r)})};var ur=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,pr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,mr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,vr=/[A-Z0-9]/g,gr=typeof document<"u",fr=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};Y.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Y.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(r){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:r})}})});var kt=F.event;function yr(){}function hr(){return this.cancelBubble}function _r(){return this.defaultPrevented}F.event=function(t){return kt&&(t=kt(t)),t.persist=yr,t.isPropagationStopped=hr,t.isDefaultPrevented=_r,t.nativeEvent=t};var Rt,br={enumerable:!1,configurable:!0,get:function(){return this.class}},St=F.vnode;F.vnode=function(t){typeof t.type=="string"&&function(r){var n=r.props,a=r.type,o={},s=a.indexOf("-")===-1;for(var i in n){var c=n[i];if(!(i==="value"&&"defaultValue"in n&&c==null||gr&&i==="children"&&a==="noscript"||i==="class"||i==="className")){var l=i.toLowerCase();i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&c===!0?c="":l==="translate"&&c==="no"?c=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?i="ondblclick":l!=="onchange"||a!=="input"&&a!=="textarea"||fr(n.type)?l==="onfocus"?i="onfocusin":l==="onblur"?i="onfocusout":mr.test(i)&&(i=l):l=i="oninput":s&&pr.test(i)?i=i.replace(vr,"-$&").toLowerCase():c===null&&(c=void 0),l==="oninput"&&o[i=l]&&(i="oninputCapture"),o[i]=c}}a=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=de(n.children).forEach(function(u){u.props.selected=o.value.indexOf(u.props.value)!=-1})),a=="select"&&o.defaultValue!=null&&(o.value=de(n.children).forEach(function(u){u.props.selected=o.multiple?o.defaultValue.indexOf(u.props.value)!=-1:o.defaultValue==u.props.value})),n.class&&!n.className?(o.class=n.class,Object.defineProperty(o,"className",br)):(n.className&&!n.class||n.class&&n.className)&&(o.class=o.className=n.className),r.props=o}(t),t.$$typeof=ur,St&&St(t)};var Ct=F.__r;F.__r=function(t){Ct&&Ct(t),Rt=t.__c};var Et=F.diffed;F.diffed=function(t){Et&&Et(t);var r=t.props,n=t.__e;n!=null&&t.type==="textarea"&&"value"in r&&r.value!==n.value&&(n.value=r.value==null?"":r.value),Rt=null};var xr=e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),wr=e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),kr=e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]});function zt({isOpen:t,title:r,message:n,confirmLabel:a="Confirm",cancelLabel:o="Cancel",variant:s="default",onConfirm:i,onCancel:c,isLoading:l=!1,children:u}){let p=V(null),d=V(null),h=V(null),S=V(null);N(()=>{t?(S.current=document.activeElement,setTimeout(()=>{h.current?.focus()},0)):S.current instanceof HTMLElement&&S.current.focus()},[t]),N(()=>{if(!t)return;let v=g=>{if(g.key==="Escape"&&!l){g.preventDefault(),c();return}if(g.key==="Enter"&&!l){document.activeElement===d.current&&(g.preventDefault(),i());return}if(g.key==="Tab"){let I=p.current?.querySelectorAll('button:not(:disabled), [href], input:not(:disabled), select:not(:disabled), textarea:not(:disabled), [tabindex]:not([tabindex="-1"])');if(!I||I.length===0)return;let P=I[0],B=I[I.length-1];g.shiftKey?document.activeElement===P&&(g.preventDefault(),B.focus()):document.activeElement===B&&(g.preventDefault(),P.focus())}};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[t,l,c,i]),N(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]);let C=O(v=>{v.target===v.currentTarget&&!l&&c()},[l,c]);if(!t)return null;let R=s==="danger"?wr:s==="warning"?xr:kr,E=`confirm-dialog-icon confirm-dialog-icon-${s}`;return e("div",{class:"confirm-dialog-overlay",onClick:C,role:"presentation",children:e("div",{ref:p,class:"confirm-dialog",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-message",children:[e("div",{class:"confirm-dialog-header",children:[e("div",{class:E,children:R}),e("h2",{id:"confirm-dialog-title",class:"confirm-dialog-title",children:r})]}),e("div",{class:"confirm-dialog-body",children:[e("p",{id:"confirm-dialog-message",class:"confirm-dialog-message",children:n}),u]}),e("div",{class:"confirm-dialog-actions",children:[e("button",{ref:h,type:"button",class:"btn btn-secondary",onClick:c,disabled:l,children:o}),e("button",{ref:d,type:"button",class:`btn ${s==="danger"?"btn-danger":s==="warning"?"btn-warning":"btn-primary"}`,onClick:i,disabled:l,children:[l&&e("span",{class:"spinner",style:{width:"14px",height:"14px"}}),a]})]})]})})}function Pt(t){let[r,n]=x(!1),a=V(null),o=V(null),s=O(()=>{a.current&&a.current.close();let i=new EventSource("/api/events");a.current=i,i.onopen=()=>{n(!0),console.log("SSE connected")},i.onerror=()=>{n(!1),i.close(),o.current&&clearTimeout(o.current),o.current=window.setTimeout(()=>{console.log("SSE reconnecting..."),s()},3e3)},["overview","worker_update","metrics","log","session","control_plane","heartbeat"].forEach(l=>{i.addEventListener(l,u=>{try{let p=JSON.parse(u.data);t({type:l,data:p.data})}catch(p){console.error("Failed to parse SSE event:",p)}})})},[t]);return N(()=>(s(),()=>{a.current&&a.current.close(),o.current&&clearTimeout(o.current)}),[s]),{connected:r}}var Sr=500,Cr=100,Mt=ae(void 0),Er={overview:null,workers:[],controlPlane:null,sessions:[],logs:[],activity:[],config:null,connected:!1};function De({children:t}){let[r,n]=x("overview"),[a,o]=x(Er),s=O(C=>{let{type:R,data:E}=C;switch(R){case"overview":o(v=>({...v,overview:E}));break;case"worker_update":o(v=>{let g=E,I=v.workers.findIndex(P=>P.id===g.id);if(I>=0){let P=[...v.workers];return P[I]=g,{...v,workers:P}}return{...v,workers:[...v.workers,g]}});break;case"worker_remove":o(v=>{let{id:g}=E;return{...v,workers:v.workers.filter(I=>I.id!==g)}});break;case"control_plane":o(v=>({...v,controlPlane:E}));break;case"session":o(v=>{let g=E,I=v.sessions.findIndex(P=>P.id===g.id);if(I>=0){let P=[...v.sessions];return P[I]=g,{...v,sessions:P}}return{...v,sessions:[...v.sessions,g]}});break;case"session_end":o(v=>{let{id:g}=E;return{...v,sessions:v.sessions.filter(I=>I.id!==g)}});break;case"log":o(v=>({...v,logs:[E,...v.logs].slice(0,Sr)}));break;case"activity":o(v=>({...v,activity:[E,...v.activity].slice(0,Cr)}));break;case"metrics":o(v=>{let{worker_id:g,metrics:I}=E,P=v.workers.map(B=>B.id===g?{...B,metrics:I}:B);return{...v,workers:P}});break;case"config":o(v=>({...v,config:E}));break}},[]),{connected:i}=Pt(s);N(()=>{o(C=>({...C,connected:i}))},[i]);let c=O(async C=>{try{let R=await fetch(C);return R.ok?await R.json():(console.error(`Failed to fetch ${C}: ${R.status}`),null)}catch(R){return console.error(`Error fetching ${C}:`,R),null}},[]),l=O(async()=>{let C=await c("/api/workers");C&&o(R=>({...R,workers:C}))},[c]),u=O(async()=>{let C=await c("/api/sessions");C&&o(R=>({...R,sessions:C}))},[c]),p=O(async()=>{let C=await c("/api/logs?limit=100");C&&o(R=>({...R,logs:C}))},[c]),d=O(async()=>{let[C,R,E,v,g,I,P]=await Promise.all([c("/api/overview"),c("/api/workers"),c("/api/control-plane"),c("/api/sessions"),c("/api/logs?limit=100"),c("/api/activity?limit=20"),c("/api/config")]);o(B=>({...B,overview:C??B.overview,workers:R??B.workers,controlPlane:E??B.controlPlane,sessions:v??B.sessions,logs:g??B.logs,activity:I??B.activity,config:P??B.config}))},[c]);N(()=>{d()},[d]);let h=O(C=>{n(C)},[]),S=te(()=>({currentPage:r,setPage:h,connected:a.connected,overview:a.overview,workers:a.workers,controlPlane:a.controlPlane,sessions:a.sessions,logs:a.logs,activity:a.activity,config:a.config,refreshAll:d,refreshWorkers:l,refreshSessions:u,refreshLogs:p}),[r,h,a.connected,a.overview,a.workers,a.controlPlane,a.sessions,a.logs,a.activity,a.config,d,l,u,p]);return e(Mt.Provider,{value:S,children:t})}function He(){let t=ue(Mt);if(t===void 0)throw new Error("useWebUI must be used within a WebUIProvider");return t}var Tr={success:3e3,error:5e3,warning:5e3,info:4e3},At=ae(void 0);function Ne({children:t,maxToasts:r=5}){let[n,a]=x([]),o=V(new Map),s=O(()=>`toast-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,[]),i=O(d=>{let h=o.current.get(d);h&&(clearTimeout(h),o.current.delete(d))},[]),c=O(d=>{i(d),a(h=>h.filter(S=>S.id!==d))},[i]),l=O(d=>{let h=s(),S=d.duration??Tr[d.type],C={...d,id:h,duration:S};if(a(R=>{let E=[...R,C];if(E.length>r){let v=E.shift();v&&i(v.id)}return E}),S>0){let R=setTimeout(()=>{c(h)},S);o.current.set(h,R)}return h},[s,r,i,c]),u=O(()=>{o.current.forEach(d=>clearTimeout(d)),o.current.clear(),a([])},[]);N(()=>()=>{o.current.forEach(d=>clearTimeout(d)),o.current.clear()},[]);let p={toasts:n,addToast:l,removeToast:c,clearAllToasts:u};return e(At.Provider,{value:p,children:t})}function we(){let t=ue(At);if(t===void 0)throw new Error("useToast must be used within a ToastProvider");return t}function Oe(){let{addToast:t}=we(),r=O((s,i)=>t({type:"success",title:s,message:i}),[t]),n=O((s,i)=>t({type:"error",title:s,message:i}),[t]),a=O((s,i)=>t({type:"warning",title:s,message:i}),[t]),o=O((s,i)=>t({type:"info",title:s,message:i}),[t]);return{success:r,error:n,warning:a,info:o,addToast:t}}var Lr=xe(function({worker:r,isRestarting:n,onRestart:a}){let o=i=>{switch(i.toLowerCase()){case"running":return e("span",{class:"badge badge-success",children:"Running"});case"busy":return e("span",{class:"badge badge-warning",children:"Busy"});case"idle":return e("span",{class:"badge badge-info",children:"Idle"});case"error":return e("span",{class:"badge badge-error",children:"Error"});case"stopping":return e("span",{class:"badge badge-warning",children:"Stopping"});default:return e("span",{class:"badge",children:i})}},s=i=>new Date(i).toLocaleString();return e("div",{class:"worker-card",children:[e("div",{class:"worker-info",children:[e("div",{class:"worker-icon",children:"\u{1F916}"}),e("div",{class:"worker-details",children:[e("h3",{children:[r.id,e("span",{style:{marginLeft:"0.5rem"},children:o(r.status)})]}),e("div",{class:"worker-meta",children:["PID: ",r.pid," \u2022 Host: ",r.hostname," \u2022 Started:"," ",s(r.started_at)]})]})]}),e("div",{class:"worker-metrics",children:[r.metrics&&e(A,{children:[e("div",{class:"metric",children:[e("div",{class:"metric-value",children:[r.metrics.cpu_percent.toFixed(1),"%"]}),e("div",{class:"metric-label",children:"CPU"})]}),e("div",{class:"metric",children:[e("div",{class:"metric-value",children:[r.metrics.memory_mb.toFixed(0)," MB"]}),e("div",{class:"metric-label",children:"Memory"})]})]}),e("div",{class:"metric",children:[e("div",{class:"metric-value",children:r.tasks_active}),e("div",{class:"metric-label",children:"Active"})]}),e("div",{class:"metric",children:[e("div",{class:"metric-value",children:r.tasks_total}),e("div",{class:"metric-label",children:"Total"})]}),e("button",{class:"btn btn-secondary",onClick:()=>a(r.id),disabled:n,children:n?e("span",{class:"spinner",style:{width:14,height:14}}):"\u21BB Restart"})]})]})});function Ir(){return e("div",{class:"worker-card",children:[e("div",{class:"worker-info",children:[e(z,{variant:"circular",width:40,height:40}),e("div",{class:"worker-details",style:{flex:1},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e(z,{variant:"text",width:120,height:"1.125rem"}),e(z,{variant:"rectangular",width:60,height:20})]}),e(z,{variant:"text",width:"80%",height:"0.75rem"})]})]}),e("div",{class:"worker-metrics",children:[e("div",{class:"metric",children:[e(z,{variant:"text",width:40,height:"1.25rem"}),e(z,{variant:"text",width:30,height:"0.75rem"})]}),e("div",{class:"metric",children:[e(z,{variant:"text",width:50,height:"1.25rem"}),e(z,{variant:"text",width:45,height:"0.75rem"})]}),e("div",{class:"metric",children:[e(z,{variant:"text",width:30,height:"1.25rem"}),e(z,{variant:"text",width:35,height:"0.75rem"})]}),e("div",{class:"metric",children:[e(z,{variant:"text",width:30,height:"1.25rem"}),e(z,{variant:"text",width:30,height:"0.75rem"})]}),e(z,{variant:"rectangular",width:80,height:32})]})]})}function Wt({workers:t,isLoading:r}){let[n,a]=x(null),[o,s]=x(null),i=Oe(),c=O(p=>{s({workerId:p})},[]),l=O(async()=>{if(!o)return;let p=o.workerId;s(null),a(p);try{let h=await(await fetch(`/api/workers/${p}/restart`,{method:"POST"})).json();h.success?i.success("Worker restarting",`Worker ${p} is being restarted`):i.error("Restart failed",h.error||"Unknown error")}catch(d){i.error("Restart failed",String(d))}finally{a(null)}},[o,i]),u=O(()=>{s(null)},[]);return r?e(A,{children:[e("div",{style:{marginBottom:"1rem"},children:e(z,{variant:"text",width:150,height:"1.5rem"})}),e("div",{class:"worker-list",children:[1,2,3].map(p=>e(Ir,{},p))})]}):t.length===0?e("div",{class:"card",children:e("div",{class:"empty-state",children:[e("div",{class:"empty-state-icon",children:"\u{1F527}"}),e("div",{children:"No workers connected"})]})}):e(A,{children:[e(zt,{isOpen:!!o,title:"Restart Worker?",message:`Are you sure you want to restart worker "${o?.workerId}"? This will interrupt any active tasks.`,confirmLabel:"Restart",cancelLabel:"Cancel",variant:"warning",onConfirm:l,onCancel:u}),e("div",{style:{marginBottom:"1rem"},children:e("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:["Workers (",t.length,")"]})}),e("div",{class:"worker-list",children:t.map(p=>e(Lr,{worker:p,isRestarting:n===p.id,onRestart:c},p.id))})]})}function Ft({status:t}){let[r,n]=x(!1),a=async()=>{n(!0);try{let i=await(await fetch("/api/control-plane/reconnect",{method:"POST"})).json();i.success||alert("Reconnect failed: "+(i.error||"Unknown error"))}catch(s){alert("Reconnect failed: "+s)}finally{n(!1)}},o=s=>s?new Date(s).toLocaleString():"Never";return t?e(A,{children:[e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"Control Plane Connection"}),e("button",{class:"btn btn-secondary",onClick:a,disabled:r,children:r?e(A,{children:[e("span",{class:"spinner",style:{width:14,height:14}}),"Reconnecting..."]}):"\u21BB Reconnect"})]}),e("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Connection Status"})}),e("table",{class:"table",children:e("tbody",{children:[e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Status"}),e("td",{children:e("span",{class:`badge ${t.connected?"badge-success":"badge-error"}`,children:t.connected?"Connected":"Disconnected"})})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"URL"}),e("td",{style:{wordBreak:"break-all"},children:t.url})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Latency"}),e("td",{children:t.latency_ms?`${t.latency_ms}ms`:"N/A"})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Last Check"}),e("td",{children:o(t.last_check)})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Last Success"}),e("td",{children:o(t.last_success)})]})]})})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Authentication"})}),e("table",{class:"table",children:e("tbody",{children:[e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Auth Status"}),e("td",{children:e("span",{class:`badge ${t.auth_status==="valid"?"badge-success":t.auth_status==="expired"?"badge-warning":"badge-error"}`,children:t.auth_status})})]}),t.config_version&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Config Version"}),e("td",{children:t.config_version})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Reconnect Count"}),e("td",{children:t.reconnect_count})]}),t.error_message&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Error"}),e("td",{style:{color:"var(--error)"},children:t.error_message})]})]})})]})]}),!t.connected&&t.error_message&&e("div",{class:"card",style:{marginTop:"1rem",borderColor:"var(--error)",background:"rgba(255, 107, 107, 0.1)"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("span",{style:{fontSize:"1.5rem"},children:"\u26A0\uFE0F"}),e("div",{children:[e("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Connection Error"}),e("div",{style:{color:"var(--text-secondary)"},children:t.error_message})]})]})})]}):e("div",{class:"card",children:e("div",{class:"loading",children:e("span",{class:"spinner"})})})}function Bt({logs:t,config:r}){let[n,a]=x(""),[o,s]=x(""),[i,c]=x(""),[l,u]=x(!0),[p,d]=x(!0),h=V(null),S=[...new Set(t.map(g=>g.component).filter(Boolean))];N(()=>{l&&h.current&&(h.current.scrollTop=h.current.scrollHeight)},[t,l]);let C=t.filter(g=>!(n&&g.level!==n||o&&g.component!==o||i&&!g.message.toLowerCase().includes(i.toLowerCase()))),R=g=>new Date(g).toLocaleTimeString("en-US",{hour12:!1}),E=g=>g==="worker-stdout"?e("span",{class:"log-component stdout",children:"stdout"}):g==="worker-stderr"?e("span",{class:"log-component stderr",children:"stderr"}):g==="worker"?e("span",{class:"log-component worker",children:"worker"}):g==="metrics"?e("span",{class:"log-component metrics",children:"metrics"}):g==="webui"?e("span",{class:"log-component webui",children:"webui"}):e("span",{class:"log-component",children:g||"system"}),v={total:t.length,errors:t.filter(g=>g.level==="ERROR").length,warnings:t.filter(g=>g.level==="WARNING").length,info:t.filter(g=>g.level==="INFO").length};return e(A,{children:[e("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Total Logs"}),e("div",{class:"stat-value",children:v.total})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Errors"}),e("div",{class:"stat-value error",children:v.errors})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Warnings"}),e("div",{class:"stat-value warning",children:v.warnings})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Info"}),e("div",{class:"stat-value",children:v.info})]})]}),e("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem"},children:[e("div",{class:"card",children:[e("div",{class:"card-header",children:[e("h3",{class:"card-title",children:["Live Logs",e("span",{style:{marginLeft:"0.5rem",fontSize:"0.75rem",color:"var(--success)"},children:"\u25CF streaming"})]}),e("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e("input",{type:"checkbox",checked:p,onChange:g=>d(g.target.checked)}),"Timestamps"]}),e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e("input",{type:"checkbox",checked:l,onChange:g=>u(g.target.checked)}),"Auto-scroll"]})]})]}),e("div",{class:"filter-bar",children:[e("select",{class:"filter-select",value:n,onChange:g=>a(g.target.value),children:[e("option",{value:"",children:"All Levels"}),e("option",{value:"DEBUG",children:"DEBUG"}),e("option",{value:"INFO",children:"INFO"}),e("option",{value:"WARNING",children:"WARNING"}),e("option",{value:"ERROR",children:"ERROR"})]}),e("select",{class:"filter-select",value:o,onChange:g=>s(g.target.value),children:[e("option",{value:"",children:"All Components"}),S.map(g=>e("option",{value:g,children:g},g))]}),e("input",{type:"text",class:"filter-input",placeholder:"Search logs...",value:i,onInput:g=>c(g.target.value),style:{flex:1}}),e("button",{class:"btn btn-secondary",onClick:()=>{a(""),s(""),c("")},style:{fontSize:"0.75rem",padding:"0.4rem 0.6rem"},children:"Clear"})]}),e("div",{class:"log-viewer",ref:h,style:{maxHeight:"500px"},children:C.length===0?e("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"2rem"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"\u{1F4DD}"}),e("div",{children:"No logs to display"}),e("div",{style:{fontSize:"0.75rem",marginTop:"0.5rem"},children:"Logs from the worker process will appear here in real-time"})]}):C.map((g,I)=>e("div",{class:`log-entry ${g.level.toLowerCase()}`,children:[p&&e("span",{class:"log-time",children:R(g.timestamp)}),e("span",{class:`log-level ${g.level.toLowerCase()}`,children:g.level}),E(g.component),e("span",{class:"log-message",children:g.message})]},I))}),e("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",justifyContent:"space-between"},children:[e("span",{children:["Showing ",C.length," of ",t.length," logs"]}),e("span",{children:"Max buffer: 1000 entries"})]})]}),e("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Configuration"})}),r?e("table",{class:"table",children:e("tbody",{children:[e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Queue ID"}),e("td",{style:{wordBreak:"break-all",fontSize:"0.8125rem"},children:r.queue_id})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Deployment"}),e("td",{children:r.deployment_type})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Daemon Mode"}),e("td",{children:r.daemon_mode?"Yes":"No"})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Auto Update"}),e("td",{children:r.auto_update?"Enabled":"Disabled"})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Local Proxy"}),e("td",{children:r.enable_local_proxy?e("span",{class:"badge badge-success",children:"Enabled"}):e("span",{class:"badge",children:"Disabled"})})]}),r.proxy_port&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Proxy Port"}),e("td",{children:r.proxy_port})]}),r.model_override&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Model Override"}),e("td",{children:r.model_override})]})]})}):e("div",{class:"loading",children:e("span",{class:"spinner"})})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Actions"})}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e("button",{class:"btn btn-secondary",onClick:()=>fetch("/api/control-plane/reconnect",{method:"POST"}),children:"\u21BB Reconnect Control Plane"})})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Environment"})}),e("table",{class:"table",children:e("tbody",{children:[r?.worker_dir&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Worker Dir"}),e("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:r.worker_dir})]}),r?.control_plane_url&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Control Plane"}),e("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:r.control_plane_url})]})]})})]})]})]})]})}function $e({onClose:t,initialAgentId:r}){let[n,a]=x([]),[o,s]=x(null),[i,c]=x([]),[l,u]=x(""),[p,d]=x(!1),[h,S]=x(!1),[C,R]=x(null),[E,v]=x(null),[g,I]=x(!r),[P,B]=x(new Set),W=V(null),G=V(null),T=V(null);N(()=>(f(),()=>{T.current&&T.current.close()}),[]),N(()=>{if(r&&n.length>0){let k=n.find(_=>_.id===r);k&&(s(k),I(!1))}},[r,n]),N(()=>{W.current?.scrollIntoView({behavior:"smooth"})},[i]),N(()=>{o&&G.current&&G.current.focus()},[o]);let f=async()=>{try{let _=await(await fetch("/api/exec/agents")).json();a(_.agents||[])}catch(k){console.error("Failed to fetch agents:",k)}},b=async k=>{s(k),I(!1),v(null);try{let _=await fetch("/api/chat/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_id:k.id})}),m=await _.json();if(!_.ok)throw new Error(m.error||"Failed to start session");R(m.session_id),S(!0),y(m.session_id)}catch(_){v(_ instanceof Error?_.message:"Failed to start session")}},y=k=>{let _=new EventSource(`/api/chat/stream/${k}`);T.current=_,_.onmessage=m=>{try{let L=JSON.parse(m.data);M(L)}catch(L){console.error("Failed to parse stream event:",L)}},_.onerror=()=>{S(!1)}},M=k=>{switch(k.type){case"connected":break;case"message_start":c(_=>[..._,{id:k.message_id||`msg-${Date.now()}`,role:"assistant",content:"",timestamp:new Date().toISOString(),isStreaming:!0}]);break;case"content_delta":c(_=>{let m=_[_.length-1];if(m?.role==="assistant"&&m.isStreaming){let L=k.content||"";if(L&&!L.startsWith("{")&&!m.content.endsWith(L))return[..._.slice(0,-1),{...m,content:m.content+L}]}return _});break;case"thinking":c(_=>{let m=_[_.length-1];return m?.role==="assistant"?[..._.slice(0,-1),{...m,thinking:(m.thinking||"")+(k.content||"")}]:_});break;case"tool_call":c(_=>{let m=_[_.length-1];if(m?.role==="assistant"){let L=m.tool_calls||[];if(!L.find(w=>w.id===k.tool_call_id))return[..._.slice(0,-1),{...m,tool_calls:[...L,{id:k.tool_call_id||`tool-${Date.now()}`,name:k.name||"Tool",input:k.input||"",status:"running"}]}]}return _});break;case"tool_result":c(_=>{let m=_[_.length-1];if(m?.role==="assistant"&&m.tool_calls){let L=m.tool_calls.map(w=>w.id===k.tool_call_id?{...w,status:k.is_error?"error":"complete",output:k.output,isError:k.is_error}:w);return[..._.slice(0,-1),{...m,tool_calls:L}]}return _});break;case"message_end":case"done":c(_=>{let m=_[_.length-1];return m?.role==="assistant"?[..._.slice(0,-1),{...m,isStreaming:!1}]:_}),d(!1);break;case"error":k.content&&v(k.content),d(!1);break;case"status":break}},D=async()=>{if(!l.trim()||!C||p)return;let k={id:`user-${Date.now()}`,role:"user",content:l.trim(),timestamp:new Date().toISOString()};c(_=>[..._,k]),u(""),d(!0),v(null);try{let _=await fetch("/api/chat/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:C,content:k.content})});if(!_.ok){let m=await _.json();throw new Error(m.error||"Failed to send message")}}catch(_){v(_ instanceof Error?_.message:"Failed to send message"),d(!1)}},H=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),D())},j=k=>{B(_=>{let m=new Set(_);return m.has(k)?m.delete(k):m.add(k),m})},U=k=>{try{return new Date(k).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return""}};return g?e("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"var(--bg-primary)",borderRadius:"16px",overflow:"hidden",boxShadow:"0 4px 24px rgba(0, 0, 0, 0.3)"},children:[e("div",{style:{padding:"1.25rem 1.5rem",background:"linear-gradient(135deg, #6366F1, #8B5CF6)",display:"flex",alignItems:"center",gap:"1rem"},children:[e("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:"\u{1F4AC}"}),e("div",{style:{flex:1},children:[e("h3",{style:{margin:0,fontSize:"1.125rem",fontWeight:600,color:"white"},children:"New Conversation"}),e("div",{style:{fontSize:"0.8125rem",color:"rgba(255, 255, 255, 0.8)"},children:"Select an agent to chat with"})]}),e("button",{onClick:t,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:"pointer",color:"white",fontSize:"1.25rem",lineHeight:1},children:"\xD7"})]}),e("div",{style:{flex:1,overflow:"auto",padding:"1rem"},children:n.length===0?e("div",{style:{textAlign:"center",padding:"3rem",color:"var(--text-muted)"},children:[e("div",{style:{fontSize:"3rem",marginBottom:"1rem",opacity:.5},children:"\u{1F916}"}),e("div",{children:"No agents available"})]}):e("div",{style:{display:"grid",gap:"0.75rem"},children:n.map(k=>e("div",{onClick:()=>b(k),style:{padding:"1rem 1.25rem",background:"var(--bg-secondary)",borderRadius:"12px",border:"2px solid transparent",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"1rem"},onMouseOver:_=>{_.currentTarget.style.borderColor="var(--accent)",_.currentTarget.style.transform="translateX(4px)"},onMouseOut:_=>{_.currentTarget.style.borderColor="transparent",_.currentTarget.style.transform="translateX(0)"},children:[e("div",{style:{width:"44px",height:"44px",borderRadius:"12px",background:"linear-gradient(135deg, #10B981, #34D399)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",flexShrink:0},children:"\u{1F916}"}),e("div",{style:{flex:1,minWidth:0},children:[e("div",{style:{fontWeight:600,fontSize:"0.9375rem",marginBottom:"0.125rem"},children:k.name}),k.description&&e("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:k.description})]}),e("span",{style:{color:"var(--accent)",fontSize:"1.25rem"},children:"\u2192"})]},k.id))})})]}):e("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"var(--bg-primary)",borderRadius:"16px",overflow:"hidden",boxShadow:"0 4px 24px rgba(0, 0, 0, 0.3)"},children:[e("div",{style:{padding:"0.875rem 1.25rem",background:"linear-gradient(135deg, #6366F1, #8B5CF6)",display:"flex",alignItems:"center",gap:"0.875rem"},children:[e("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem"},children:"\u{1F916}"}),e("div",{style:{flex:1},children:[e("div",{style:{fontWeight:600,fontSize:"1rem",color:"white"},children:o?.name||"Chat"}),e("div",{style:{fontSize:"0.6875rem",color:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:h?"#4ADE80":"#F87171",boxShadow:h?"0 0 8px #4ADE80":"0 0 8px #F87171"}}),h?"Connected":"Disconnected"]})]}),e("button",{onClick:()=>I(!0),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",padding:"0.5rem 0.75rem",cursor:"pointer",color:"white",fontSize:"0.75rem"},children:"Switch"}),e("button",{onClick:t,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:"pointer",color:"white",fontSize:"1.25rem",lineHeight:1},children:"\xD7"})]}),E&&e("div",{style:{padding:"0.75rem 1.25rem",background:"rgba(239, 68, 68, 0.15)",borderBottom:"1px solid rgba(239, 68, 68, 0.3)",color:"#F87171",fontSize:"0.8125rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{children:"\u26A0\uFE0F"}),e("span",{style:{flex:1},children:E}),e("button",{onClick:()=>v(null),style:{background:"none",border:"none",color:"#F87171",cursor:"pointer",padding:"0.25rem"},children:"\xD7"})]}),e("div",{style:{flex:1,overflow:"auto",padding:"1.25rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[i.length===0&&e("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",textAlign:"center",padding:"2rem"},children:[e("div",{style:{fontSize:"3rem",marginBottom:"1rem",opacity:.5},children:"\u{1F44B}"}),e("div",{style:{fontSize:"1rem",marginBottom:"0.25rem"},children:"Ready to chat!"}),e("div",{style:{fontSize:"0.8125rem"},children:"Send a message to start the conversation"})]}),i.map(k=>e("div",{style:{display:"flex",flexDirection:"column",alignItems:k.role==="user"?"flex-end":"flex-start",gap:"0.375rem"},children:[k.thinking&&e("div",{style:{maxWidth:"85%",padding:"0.75rem 1rem",background:"rgba(139, 92, 246, 0.15)",borderRadius:"12px",borderLeft:"3px solid #8B5CF6",fontSize:"0.8125rem",color:"#C4B5FD",fontStyle:"italic"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.375rem",fontWeight:500},children:"\u{1F4AD} Thinking"}),k.thinking]}),k.tool_calls&&k.tool_calls.length>0&&e("div",{style:{maxWidth:"85%",display:"flex",flexDirection:"column",gap:"0.5rem"},children:k.tool_calls.map(_=>{let m=P.has(_.id);return e("div",{style:{background:"var(--bg-secondary)",borderRadius:"12px",overflow:"hidden",border:`1px solid ${_.status==="error"?"rgba(239, 68, 68, 0.5)":"var(--border)"}`},children:[e("div",{onClick:()=>j(_.id),style:{padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"0.625rem",cursor:"pointer",background:_.status==="running"?"rgba(99, 102, 241, 0.1)":_.status==="error"?"rgba(239, 68, 68, 0.1)":_.status==="complete"?"rgba(16, 185, 129, 0.1)":"transparent"},children:[e("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:_.status==="error"?"#EF4444":_.status==="complete"?"#10B981":"linear-gradient(135deg, #6366F1, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",color:"white"},children:_.status==="running"?e("span",{class:"spinner",style:{width:14,height:14}}):_.status==="error"?"\u2715":_.status==="complete"?"\u2713":"\u{1F527}"}),e("div",{style:{flex:1,minWidth:0},children:[e("div",{style:{fontWeight:600,fontSize:"0.8125rem",color:"#A78BFA"},children:_.name}),!m&&_.input&&e("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:_.input.length>60?_.input.slice(0,60)+"...":_.input})]}),e("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",transform:m?"rotate(180deg)":"rotate(0)",transition:"transform 0.2s"},children:"\u25BC"})]}),m&&e("div",{style:{padding:"0.75rem 1rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",fontFamily:"ui-monospace, monospace"},children:[_.input&&e("div",{style:{marginBottom:_.output?"0.75rem":0},children:[e("div",{style:{color:"var(--text-muted)",marginBottom:"0.375rem",fontWeight:500},children:"Input"}),e("pre",{style:{margin:0,padding:"0.625rem",background:"var(--bg-hover)",borderRadius:"6px",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"150px",overflow:"auto",color:"var(--text-secondary)"},children:_.input})]}),_.output&&e("div",{children:[e("div",{style:{color:_.isError?"#F87171":"var(--text-muted)",marginBottom:"0.375rem",fontWeight:500},children:_.isError?"Error":"Output"}),e("pre",{style:{margin:0,padding:"0.625rem",background:_.isError?"rgba(239, 68, 68, 0.1)":"var(--bg-hover)",borderRadius:"6px",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"200px",overflow:"auto",color:_.isError?"#F87171":"var(--text-secondary)"},children:_.output})]})]})]},_.id)})}),k.content&&e("div",{style:{maxWidth:"85%",padding:"0.875rem 1.125rem",borderRadius:k.role==="user"?"18px 18px 4px 18px":"18px 18px 18px 4px",background:k.role==="user"?"linear-gradient(135deg, #6366F1, #8B5CF6)":"var(--bg-secondary)",color:k.role==="user"?"white":"var(--text-primary)",fontSize:"0.9375rem",lineHeight:1.5,wordBreak:"break-word",whiteSpace:"pre-wrap"},children:[k.content,k.isStreaming&&e("span",{class:"spinner",style:{width:12,height:12,marginLeft:"0.5rem",verticalAlign:"middle"}})]}),e("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",paddingLeft:k.role==="user"?0:"0.5rem",paddingRight:k.role==="user"?"0.5rem":0},children:U(k.timestamp)})]},k.id)),e("div",{ref:W})]}),e("div",{style:{padding:"1rem 1.25rem",borderTop:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[e("div",{style:{display:"flex",gap:"0.75rem",alignItems:"flex-end"},children:[e("textarea",{ref:G,value:l,onInput:k=>u(k.target.value),onKeyDown:H,disabled:!h||p,placeholder:h?"Type a message...":"Connecting...",rows:1,style:{flex:1,padding:"0.875rem 1rem",borderRadius:"16px",border:"2px solid var(--border)",background:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"0.9375rem",resize:"none",minHeight:"48px",maxHeight:"120px",fontFamily:"inherit",lineHeight:1.4,outline:"none",transition:"border-color 0.2s"},onFocus:k=>k.target.style.borderColor="var(--accent)",onBlur:k=>k.target.style.borderColor="var(--border)"}),e("button",{onClick:D,disabled:!l.trim()||!h||p,style:{padding:"0.875rem 1.5rem",borderRadius:"16px",border:"none",background:!l.trim()||!h||p?"var(--bg-hover)":"linear-gradient(135deg, #6366F1, #8B5CF6)",color:!l.trim()||!h||p?"var(--text-muted)":"white",fontSize:"0.9375rem",fontWeight:600,cursor:!l.trim()||!h||p?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem",height:"48px",transition:"all 0.2s"},children:p?e("span",{class:"spinner",style:{width:18,height:18}}):e(A,{children:["Send",e("span",{style:{fontSize:"1.125rem"},children:"\u2191"})]})})]}),e("div",{style:{marginTop:"0.5rem",fontSize:"0.6875rem",color:"var(--text-muted)",display:"flex",justifyContent:"space-between"},children:[e("span",{children:"Enter to send \u2022 Shift+Enter for new line"}),e("span",{children:[i.filter(k=>k.role!=="system").length," messages"]})]})]})]})}var Rr=xe(function({session:r,onContinue:n}){let a=i=>i?new Date(i).toLocaleString():"N/A",o=i=>{switch(i.toLowerCase()){case"active":return e("span",{class:"badge badge-success",children:"Active"});case"completed":return e("span",{class:"badge badge-info",children:"Completed"});case"failed":return e("span",{class:"badge badge-error",children:"Failed"});case"cancelled":return e("span",{class:"badge badge-warning",children:"Cancelled"});default:return e("span",{class:"badge",children:i})}},s=i=>{switch(i.toLowerCase()){case"chat":return e("span",{class:"badge badge-info",children:"\u{1F4AC} Chat"});case"streaming":return e("span",{class:"badge badge-warning",children:"\u{1F4E1} Streaming"});case"execution":return e("span",{class:"badge badge-success",children:"\u26A1 Execution"});default:return e("span",{class:"badge",children:i})}};return e("tr",{children:[e("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:[r.id.slice(0,8),"..."]}),e("td",{children:s(r.type)}),e("td",{children:o(r.status)}),e("td",{children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e("span",{style:{fontSize:"0.875rem"},children:"\u{1F916}"}),e("span",{style:{fontSize:"0.8125rem"},children:r.agent_name||r.agent_id?.slice(0,8)||"-"})]})}),e("td",{style:{fontSize:"0.8125rem"},children:a(r.started_at)}),e("td",{children:r.duration_str||"-"}),e("td",{children:e("span",{style:{background:"var(--bg-hover)",padding:"0.125rem 0.5rem",borderRadius:"12px",fontSize:"0.75rem"},children:r.messages_count})}),e("td",{children:e("div",{style:{display:"flex",gap:"0.375rem"},children:[r.status==="active"&&r.agent_id&&e("button",{class:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.6875rem"},onClick:()=>n(r.agent_id),title:"Continue conversation",children:"\u{1F4AC}"}),e("button",{class:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.6875rem"},title:"View details",children:"\u{1F441}"})]})})]})});function Dt({sessions:t}){let[r,n]=x(!1),[a,o]=x(void 0),[s,i]=x("list"),c=te(()=>({active:t.filter(p=>p.status==="active").length,completed:t.filter(p=>p.status==="completed").length,messages:t.reduce((p,d)=>p+d.messages_count,0),tokens:t.reduce((p,d)=>p+(d.tokens_used||0),0)}),[t]),l=O(p=>{o(p),n(!0),i("chat")},[]),u=O(()=>{n(!1),o(void 0),i("list")},[]);return s==="chat"&&r?e("div",{style:{height:"calc(100vh - 140px)"},children:e($e,{onClose:u,initialAgentId:a})}):e(A,{children:[e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("div",{children:[e("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.125rem"},children:"Sessions"}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[t.length," total sessions"]})]}),e("button",{class:"btn btn-primary",onClick:()=>l(),style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{style:{fontSize:"1.125rem"},children:"\u{1F4AC}"}),"New Conversation"]})]}),e("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"0.75rem",marginBottom:"1.5rem"},children:[e("div",{style:{padding:"1rem",background:"linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.1))",borderRadius:"12px",border:"1px solid rgba(99, 102, 241, 0.3)",cursor:"pointer",transition:"all 0.2s"},onClick:()=>l(),onMouseOver:p=>{p.currentTarget.style.transform="translateY(-2px)",p.currentTarget.style.boxShadow="0 4px 12px rgba(99, 102, 241, 0.2)"},onMouseOut:p=>{p.currentTarget.style.transform="translateY(0)",p.currentTarget.style.boxShadow="none"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #6366F1, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:"\u{1F4AC}"}),e("div",{children:[e("div",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"Start Chat"}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Talk to an AI agent"})]})]})}),e("div",{style:{padding:"1rem",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(52, 211, 153, 0.1))",borderRadius:"12px",border:"1px solid rgba(16, 185, 129, 0.3)",cursor:"pointer",transition:"all 0.2s"},onClick:()=>window.location.hash="#playground",onMouseOver:p=>{p.currentTarget.style.transform="translateY(-2px)",p.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.2)"},onMouseOut:p=>{p.currentTarget.style.transform="translateY(0)",p.currentTarget.style.boxShadow="none"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #10B981, #34D399)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:"\u{1F680}"}),e("div",{children:[e("div",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"Execute Task"}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Run a one-shot execution"})]})]})})]}),e("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.75rem",marginBottom:"1.5rem"},children:[e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Active"}),e("div",{class:"stat-value success",children:c.active})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Completed"}),e("div",{class:"stat-value",children:c.completed})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Messages"}),e("div",{class:"stat-value",children:c.messages})]}),e("div",{class:"stat-card",children:[e("div",{class:"stat-label",children:"Tokens"}),e("div",{class:"stat-value",children:c.tokens.toLocaleString()})]})]}),t.length===0?e("div",{class:"card",children:e("div",{class:"empty-state",children:[e("div",{class:"empty-state-icon",children:"\u{1F4AC}"}),e("div",{children:"No sessions yet"}),e("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Start a new conversation to begin"}),e("button",{class:"btn btn-primary",style:{marginTop:"1rem"},onClick:()=>l(),children:"Start Conversation"})]})}):e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Recent Sessions"})}),e("table",{class:"table",children:[e("thead",{children:e("tr",{children:[e("th",{children:"Session"}),e("th",{children:"Type"}),e("th",{children:"Status"}),e("th",{children:"Agent"}),e("th",{children:"Started"}),e("th",{children:"Duration"}),e("th",{children:"Messages"}),e("th",{children:"Actions"})]})}),e("tbody",{children:t.map(p=>e(Rr,{session:p,onContinue:l},p.id))})]})]}),r&&s==="list"&&e("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"2rem"},children:e("div",{style:{width:"100%",maxWidth:"700px",height:"80vh",maxHeight:"700px"},children:e($e,{onClose:u,initialAgentId:a})})})]})}function Ht(){let[t,r]=x(null),[n,a]=x(!1),[o,s]=x(null),[i,c]=x(new Set),l=async()=>{a(!0),s(null);try{let v=await fetch("/api/doctor");if(!v.ok)throw new Error(`HTTP ${v.status}`);let g=await v.json();r(g)}catch(v){s(`Failed to run diagnostics: ${v}`)}finally{a(!1)}};N(()=>{l()},[]);let u=v=>{let g=new Set(i);g.has(v)?g.delete(v):g.add(v),c(g)},p=v=>{switch(v){case"pass":return"\u2713";case"fail":return"\u2717";case"warning":return"\u26A0";case"skip":return"\u25CB";default:return"?"}},d=v=>{switch(v){case"pass":return"var(--success)";case"fail":return"var(--error)";case"warning":return"var(--warning)";case"skip":return"var(--text-muted)";default:return"var(--text-secondary)"}},h=v=>{switch(v){case"healthy":return"var(--success)";case"degraded":return"var(--warning)";case"unhealthy":return"var(--error)";default:return"var(--text-secondary)"}},S=v=>{switch(v){case"python":return"\u{1F40D}";case"packages":return"\u{1F4E6}";case"connectivity":return"\u{1F310}";case"config":return"\u2699\uFE0F";case"process":return"\u{1F527}";default:return"\u{1F4CB}"}},C=v=>{let g={};for(let I of v)g[I.category]||(g[I.category]=[]),g[I.category].push(I);return g},R=v=>new Date(v).toLocaleString();if(n&&!t)return e("div",{class:"card",children:e("div",{style:{textAlign:"center",padding:"3rem"},children:[e("span",{class:"spinner",style:{width:"32px",height:"32px"}}),e("div",{style:{marginTop:"1rem",color:"var(--text-secondary)"},children:"Running diagnostics..."})]})});if(o&&!t)return e("div",{class:"card",style:{borderColor:"var(--error)"},children:e("div",{style:{textAlign:"center",padding:"2rem"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"\u274C"}),e("div",{style:{color:"var(--error)",marginBottom:"1rem"},children:o}),e("button",{class:"btn btn-primary",onClick:l,children:"Retry"})]})});let E=t?C(t.checks):{};return e(A,{children:[e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"System Diagnostics"}),e("button",{class:"btn btn-primary",onClick:l,disabled:n,children:n?e(A,{children:[e("span",{class:"spinner",style:{width:14,height:14}}),"Running..."]}):"\u{1F504} Run Diagnostics"})]}),t&&e(A,{children:[e("div",{class:"card",style:{marginBottom:"1rem",borderColor:h(t.overall),background:`${h(t.overall)}15`},children:e("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:h(t.overall),display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:t.overall==="healthy"?"\u2713":t.overall==="degraded"?"\u26A0":"\u2717"}),e("div",{children:[e("div",{style:{fontSize:"1.25rem",fontWeight:600,textTransform:"capitalize"},children:t.overall}),e("div",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:["Last checked: ",R(t.timestamp)]})]})]}),e("div",{style:{display:"flex",gap:"1.5rem",textAlign:"center"},children:[e("div",{children:[e("div",{style:{fontSize:"1.5rem",fontWeight:600,color:"var(--success)"},children:t.summary.passed}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Passed"})]}),e("div",{children:[e("div",{style:{fontSize:"1.5rem",fontWeight:600,color:"var(--error)"},children:t.summary.failed}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Failed"})]}),e("div",{children:[e("div",{style:{fontSize:"1.5rem",fontWeight:600,color:"var(--warning)"},children:t.summary.warnings}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Warnings"})]}),t.summary.skipped>0&&e("div",{children:[e("div",{style:{fontSize:"1.5rem",fontWeight:600,color:"var(--text-muted)"},children:t.summary.skipped}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Skipped"})]})]})]})}),e("div",{style:{display:"grid",gap:"1rem"},children:Object.entries(E).map(([v,g])=>{let I=g.filter(W=>W.status==="fail").length,P=g.filter(W=>W.status==="warning").length,B=I>0?"fail":P>0?"warning":"pass";return e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{children:S(v)}),e("span",{style:{textTransform:"capitalize"},children:v}),e("span",{class:`badge ${B==="pass"?"badge-success":B==="warning"?"badge-warning":"badge-error"}`,style:{marginLeft:"0.5rem"},children:[g.filter(W=>W.status==="pass").length,"/",g.length]})]})}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:g.map(W=>e("div",{style:{padding:"0.75rem",background:W.status==="fail"?"rgba(255, 107, 107, 0.1)":W.status==="warning"?"rgba(255, 193, 7, 0.1)":"var(--bg-hover)",borderRadius:"6px",cursor:W.remediation||W.details?"pointer":"default"},onClick:()=>(W.remediation||W.details)&&u(W.name),children:[e("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("span",{style:{color:d(W.status),fontWeight:600,fontSize:"1rem"},children:p(W.status)}),e("div",{children:[e("div",{style:{fontWeight:500},children:W.name}),e("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:W.message})]})]}),e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[W.duration_ms,"ms"]}),(W.remediation||W.details)&&e("span",{style:{color:"var(--text-muted)"},children:i.has(W.name)?"\u25BC":"\u25B6"})]})]}),i.has(W.name)&&e("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)"},children:[W.remediation&&e("div",{style:{marginBottom:"0.5rem"},children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Remediation:"}),e("div",{style:{fontSize:"0.8125rem",padding:"0.5rem",background:"var(--bg-primary)",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:W.remediation})]}),W.details&&e("div",{children:[e("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Details:"}),e("pre",{style:{fontSize:"0.75rem",padding:"0.5rem",background:"var(--bg-primary)",borderRadius:"4px",overflow:"auto",margin:0},children:JSON.stringify(W.details,null,2)})]})]})]},W.name))})]},v)})}),t.summary.failed>0&&e("div",{class:"card",style:{marginTop:"1rem"},children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Suggested Actions"})}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.checks.filter(v=>v.status==="fail"&&v.remediation).map(v=>e("div",{style:{padding:"0.75rem",background:"var(--bg-hover)",borderRadius:"6px",borderLeft:"3px solid var(--error)"},children:[e("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:v.name}),e("div",{style:{fontSize:"0.8125rem",fontFamily:"monospace",color:"var(--text-secondary)"},children:v.remediation})]},v.name))})]})]})]})}function Nt(){let[t,r]=x(null),[n,a]=x([]),[o,s]=x(!0),[i,c]=x(!1),[l,u]=x(null),[p,d]=x(""),[h,S]=x(""),[C,R]=x(!1),[E,v]=x({enabled:!1,public_key:"",secret_key:"",host:"https://cloud.langfuse.com"}),g=V(null),I=async()=>{try{let f=await(await fetch("/api/proxy/status")).json();r(f)}catch(T){u(`Failed to fetch proxy status: ${T}`)}finally{s(!1)}},P=async()=>{try{let T=new URLSearchParams;T.set("lines","200"),p&&T.set("search",p),h&&T.set("level",h);let b=await(await fetch(`/api/proxy/logs?${T}`)).json();a(b.logs||[])}catch(T){console.error("Failed to fetch proxy logs:",T)}};N(()=>{I(),P();let T=setInterval(I,1e4);return()=>clearInterval(T)},[]),N(()=>{P()},[p,h]),N(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[n]);let B=async T=>{c(!0);try{let b=await(await fetch("/api/proxy/control",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:T})})).json();b.success||alert(b.message||b.error||"Action failed"),I()}catch(f){alert(`Action failed: ${f}`)}finally{c(!1)}},W=async()=>{try{let f=await(await fetch("/api/proxy/langfuse",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)})).json();f.success?(alert("Langfuse configuration saved"),R(!1)):alert(f.message||f.error||"Failed to save Langfuse config")}catch(T){alert(`Failed to save: ${T}`)}},G=T=>{switch(T){case"healthy":return"var(--success)";case"unhealthy":return"var(--error)";case"disabled":return"var(--text-muted)";default:return"var(--warning)"}};return o?e("div",{class:"card",children:e("div",{style:{textAlign:"center",padding:"3rem"},children:[e("span",{class:"spinner",style:{width:"32px",height:"32px"}}),e("div",{style:{marginTop:"1rem",color:"var(--text-secondary)"},children:"Loading proxy status..."})]})}):e(A,{children:[e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"LiteLLM Proxy"}),e("div",{style:{display:"flex",gap:"0.5rem"},children:[e("button",{class:"btn btn-secondary",onClick:()=>R(!C),children:"\u{1F527} Langfuse"}),e("button",{class:"btn btn-secondary",onClick:()=>{I(),P()},children:"\u21BB Refresh"})]})]}),l&&e("div",{class:"card",style:{borderColor:"var(--error)",marginBottom:"1rem"},children:e("div",{style:{color:"var(--error)"},children:l})}),e("div",{class:"card",style:{marginBottom:"1rem",borderColor:t?.running?"var(--success)":"var(--text-muted)"},children:e("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:t?.running?"var(--success)":"var(--bg-hover)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:t?.running?"\u{1F7E2}":"\u26AA"}),e("div",{children:[e("div",{style:{fontSize:"1.125rem",fontWeight:600},children:t?.running?"Running":"Stopped"}),e("div",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:["Health: ",e("span",{style:{color:G(t?.health_status||"unknown")},children:t?.health_status||"unknown"})]})]})]}),e("div",{style:{display:"flex",gap:"0.5rem"},children:t?.running?e(A,{children:[e("button",{class:"btn btn-secondary",onClick:()=>B("restart"),disabled:i,children:"\u21BB Restart"}),e("button",{class:"btn btn-danger",onClick:()=>B("stop"),disabled:i,children:"\u25A0 Stop"})]}):e("button",{class:"btn btn-primary",onClick:()=>B("start"),disabled:i,children:"\u25B6 Start"})})]})}),C&&e("div",{class:"card",style:{marginBottom:"1rem"},children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Langfuse Configuration"})}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("input",{type:"checkbox",checked:E.enabled,onChange:T=>v({...E,enabled:T.target.checked})}),e("span",{children:"Enable Langfuse"})]}),E.enabled&&e(A,{children:[e("div",{children:[e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Public Key"}),e("input",{type:"text",class:"filter-input",style:{width:"100%"},value:E.public_key,onInput:T=>v({...E,public_key:T.target.value}),placeholder:"pk-lf-..."})]}),e("div",{children:[e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Secret Key"}),e("input",{type:"password",class:"filter-input",style:{width:"100%"},value:E.secret_key,onInput:T=>v({...E,secret_key:T.target.value}),placeholder:"sk-lf-..."})]}),e("div",{children:[e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Host"}),e("input",{type:"text",class:"filter-input",style:{width:"100%"},value:E.host,onInput:T=>v({...E,host:T.target.value}),placeholder:"https://cloud.langfuse.com"})]})]}),e("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e("button",{class:"btn btn-secondary",onClick:()=>R(!1),children:"Cancel"}),e("button",{class:"btn btn-primary",onClick:W,children:"Save"})]})]})]}),e("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Connection"})}),e("table",{class:"table",children:e("tbody",{children:[e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Base URL"}),e("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:t?.base_url||"N/A"})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Port"}),e("td",{children:t?.port||"N/A"})]}),e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"PID"}),e("td",{children:t?.pid||"N/A"})]}),t?.config_path&&e("tr",{children:[e("td",{style:{color:"var(--text-secondary)"},children:"Config"}),e("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:t.config_path})]})]})})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Configured Models"})}),t?.models&&t.models.length>0?e("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:t.models.map(T=>e("span",{class:"badge badge-info",style:{fontSize:"0.75rem"},children:T},T))}):e("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"1rem"},children:"No models configured"})]})]}),e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:["Proxy Logs",e("span",{style:{marginLeft:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:["(",n.length," lines)"]})]})}),e("div",{class:"filter-bar",style:{marginBottom:"0.75rem"},children:[e("input",{type:"text",class:"filter-input",placeholder:"Search logs...",value:p,onInput:T=>d(T.target.value),style:{flex:1}}),e("select",{class:"filter-select",value:h,onChange:T=>S(T.target.value),children:[e("option",{value:"",children:"All Levels"}),e("option",{value:"ERROR",children:"ERROR"}),e("option",{value:"WARNING",children:"WARNING"}),e("option",{value:"INFO",children:"INFO"})]}),e("button",{class:"btn btn-secondary",onClick:()=>{d(""),S("")},style:{fontSize:"0.75rem",padding:"0.4rem 0.6rem"},children:"Clear"})]}),e("div",{class:"log-viewer",ref:g,style:{maxHeight:"400px",fontSize:"0.75rem"},children:n.length===0?e("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"2rem"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"\u{1F4DD}"}),e("div",{children:"No proxy logs available"}),e("div",{style:{fontSize:"0.75rem",marginTop:"0.5rem"},children:"Logs will appear here when the proxy is running"})]}):n.map((T,f)=>{let b=T.includes("ERROR"),y=T.includes("WARNING")||T.includes("WARN");return e("div",{class:`log-entry ${b?"error":y?"warning":""}`,style:{padding:"0.25rem 0"},children:e("span",{class:"log-message",children:T})},f)})})]})]})}var zr={anthropic:"https://cdn.worldvectorlogo.com/logos/anthropic-1.svg",openai:"https://cdn.worldvectorlogo.com/logos/openai-2.svg",google:"https://www.gstatic.com/lamda/images/gemini_sparkle_v002_d4735304ff6292a690345.svg",meta:"https://cdn.worldvectorlogo.com/logos/meta-1.svg",cohere:"https://asset.brandfetch.io/idnRPijCxn/idHoZNvfAe.svg",mistral:"https://mistral.ai/images/logo_mistral_ai.svg",groq:"https://groq.com/wp-content/uploads/2024/03/PBG-mark1-color.svg",aws:"https://upload.wikimedia.org/wikipedia/commons/9/93/Amazon_Web_Services_Logo.svg",azure:"https://cdn.worldvectorlogo.com/logos/azure-1.svg",vertex:"https://www.gstatic.com/devrel-devsite/prod/v0e0f589edd85502a40d78d7d0825db8ea5ef3b99ab4070381ee86977c9168730/cloud/images/cloud-logo.svg",deepseek:"https://chat.deepseek.com/favicon.ico",together:"https://www.together.ai/favicon.ico",fireworks:"https://fireworks.ai/favicon.ico",perplexity:"https://www.perplexity.ai/favicon.svg",replicate:"https://replicate.com/favicon.ico"},Pr={anthropic:"#D4A27F",openai:"#10A37F",google:"#4285F4",meta:"#0668E1",cohere:"#D18EE2",mistral:"#F54E42",groq:"#F55036",aws:"#FF9900",azure:"#0089D6",vertex:"#4285F4",deepseek:"#536DFE",together:"#6366F1",fireworks:"#FF6B35",perplexity:"#20808D",replicate:"#000000"},Mr={anthropic:"\u{1F170}\uFE0F",openai:"\u{1F9E0}",google:"\u{1F535}",meta:"\u{1F4D8}",cohere:"\u{1F4AC}",mistral:"\u{1F32A}\uFE0F",groq:"\u26A1",aws:"\u2601\uFE0F",azure:"\u{1F537}",vertex:"\u{1F53A}",deepseek:"\u{1F50D}",together:"\u{1F91D}",fireworks:"\u{1F386}",perplexity:"\u{1F52E}",replicate:"\u{1F504}"};function Ot(){let[t,r]=x(null),[n,a]=x(!0),[o,s]=x(null),[i,c]=x(""),[l,u]=x(""),[p,d]=x(new Set),[h,S]=x(null),[C,R]=x(""),[E,v]=x([]),[g,I]=x(!1),[P,B]=x(null),W=V(null),G=async()=>{a(!0),s(null);try{let L=await(await fetch("/api/llm/insights")).json();L.error&&s(L.error),r(L)}catch(m){s(`Failed to fetch LLM insights: ${m}`)}finally{a(!1)}};N(()=>{G()},[]),N(()=>{W.current?.scrollIntoView({behavior:"smooth"})},[E]);let T=m=>{let L=new Set(p);L.has(m)?L.delete(m):L.add(m),d(L)},f=m=>m.toLowerCase().replace(/[\s-_]+/g,""),b=m=>{let L=f(m);return zr[L]||null},y=m=>{let L=f(m);return Pr[L]||"#6B7280"},M=m=>{let L=f(m);return Mr[L]||"\u{1F916}"},D=async()=>{if(!C.trim()||!h)return;let m={role:"user",content:C};v(L=>[...L,m]),R(""),I(!0),B(null);try{let w=await(await fetch("/api/llm/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:h,messages:[...E,m]})})).json();if(w.success&&w.response){let $={role:"assistant",content:w.response};v(J=>[...J,$])}B(w)}catch(L){B({success:!1,error:`Request failed: ${L}`})}finally{I(!1)}},H=m=>{S(m),v([]),B(null),R("")},j=()=>{S(null),v([]),B(null)},U=t?.models?.filter(m=>!(i&&!m.label.toLowerCase().includes(i.toLowerCase())&&!m.value.toLowerCase().includes(i.toLowerCase())||l&&m.provider!==l))||[],k=[...new Set(t?.models?.map(m=>m.provider)||[])];return n&&!t?e(A,{children:[e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e(z,{variant:"text",width:220,height:"1.5rem"}),e(z,{variant:"rectangular",width:90,height:36})]}),e("div",{style:{marginBottom:"1.5rem"},children:[e(z,{variant:"text",width:100,height:"1.125rem",className:"skeleton-mb-sm"}),e("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem",marginTop:"0.75rem"},children:[1,2,3,4].map(m=>e("div",{class:"card",style:{padding:"1rem"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e(z,{variant:"rectangular",width:40,height:40}),e("div",{style:{flex:1},children:[e(z,{variant:"text",width:"70%",height:"1rem"}),e(z,{variant:"text",width:"40%",height:"0.75rem"})]})]}),e(z,{variant:"text",width:80,height:"1.25rem"})]},m))})]}),e("div",{class:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e(z,{variant:"rectangular",width:56,height:56}),e("div",{style:{flex:1},children:[e(z,{variant:"text",width:100,height:"0.75rem"}),e(z,{variant:"text",width:180,height:"1.5rem"}),e(z,{variant:"text",width:140,height:"0.875rem"})]}),e(z,{variant:"rectangular",width:70,height:36})]})}),e("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e(z,{variant:"rectangular",width:"100%",height:38}),e(z,{variant:"rectangular",width:150,height:38}),e(z,{variant:"rectangular",width:60,height:38})]}),e(z,{variant:"text",width:180,height:"0.875rem",className:"skeleton-mb-sm"}),e("div",{style:{display:"grid",gap:"0.75rem",marginTop:"0.75rem"},children:[1,2,3,4,5].map(m=>e("div",{class:"card",style:{padding:"1rem"},children:e("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[e(z,{variant:"rectangular",width:44,height:44}),e("div",{style:{flex:1},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e(z,{variant:"text",width:150,height:"1rem"}),e(z,{variant:"rectangular",width:70,height:18})]}),e(z,{variant:"text",width:"60%",height:"0.75rem"}),e("div",{style:{display:"flex",gap:"0.25rem",marginTop:"0.5rem"},children:[e(z,{variant:"rectangular",width:60,height:18}),e(z,{variant:"rectangular",width:50,height:18}),e(z,{variant:"rectangular",width:70,height:18})]})]}),e("div",{style:{display:"flex",gap:"0.375rem"},children:[e(z,{variant:"rectangular",width:65,height:32}),e(z,{variant:"rectangular",width:32,height:32})]})]})},m))})]}):e(A,{children:[(()=>{if(!h)return null;let m=t?.models?.find(L=>L.value===h);return e("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"1rem"},onClick:L=>{L.target===L.currentTarget&&j()},children:e("div",{class:"card",style:{width:"100%",maxWidth:"700px",maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[m&&e("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:y(m.provider),display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:[b(m.provider)?e("img",{src:b(m.provider),alt:m.provider,style:{width:"24px",height:"24px",objectFit:"contain"},onError:L=>{L.target.style.display="none",L.target.nextElementSibling.removeAttribute("style")}}):null,e("span",{style:{fontSize:"1.25rem",display:b(m.provider)?"none":"block"},children:M(m.provider)})]}),e("div",{children:[e("div",{style:{fontWeight:600},children:m?.label||h}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Chat Completion Test"})]})]}),e("button",{class:"btn btn-secondary",style:{padding:"0.25rem 0.5rem"},onClick:j,children:"\u2715"})]}),e("div",{style:{flex:1,overflow:"auto",padding:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem",minHeight:"300px"},children:[E.length===0&&e("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"\u{1F4AC}"}),e("div",{children:"Send a message to test the model"})]}),E.map((L,w)=>e("div",{style:{alignSelf:L.role==="user"?"flex-end":"flex-start",maxWidth:"80%",padding:"0.75rem 1rem",borderRadius:"12px",background:L.role==="user"?"var(--accent)":"var(--bg-hover)",color:L.role==="user"?"white":"var(--text-primary)"},children:e("div",{style:{fontSize:"0.8125rem",whiteSpace:"pre-wrap"},children:L.content})},w)),g&&e("div",{style:{alignSelf:"flex-start",padding:"0.75rem 1rem",borderRadius:"12px",background:"var(--bg-hover)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{class:"spinner",style:{width:14,height:14}}),e("span",{style:{color:"var(--text-secondary)"},children:"Thinking..."})]}),e("div",{ref:W})]}),P&&e("div",{style:{padding:"0.5rem 1rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",color:P.success?"var(--success)":"var(--error)",display:"flex",alignItems:"center",gap:"1rem"},children:P.success?e(A,{children:[e("span",{children:"\u2713 Success"}),P.latency_ms&&e("span",{children:["Latency: ",P.latency_ms,"ms"]}),P.tokens_used&&e("span",{children:["Tokens: ",P.tokens_used]})]}):e("span",{children:["\u2717 ",P.error]})}),e("div",{style:{padding:"1rem",borderTop:"1px solid var(--border)",display:"flex",gap:"0.5rem"},children:[e("input",{type:"text",class:"filter-input",style:{flex:1},placeholder:"Type a message...",value:C,onInput:L=>R(L.target.value),onKeyDown:L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),D())},disabled:g}),e("button",{class:"btn btn-primary",onClick:D,disabled:g||!C.trim(),children:g?e("span",{class:"spinner",style:{width:14,height:14}}):"Send"})]})]})})})(),e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"LLM Models & Providers"}),e("button",{class:"btn btn-secondary",onClick:G,disabled:n,children:n?e(A,{children:[e("span",{class:"spinner",style:{width:14,height:14}}),"Loading..."]}):"\u21BB Refresh"})]}),o&&e("div",{class:"card",style:{borderColor:"var(--warning)",marginBottom:"1rem"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--warning)"},children:[e("span",{children:"\u26A0\uFE0F"}),e("span",{children:o})]})}),t?.providers&&t.providers.length>0&&e("div",{style:{marginBottom:"1.5rem"},children:[e("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"0.75rem"},children:"Providers"}),e("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},children:t.providers.map(m=>{let L=b(m.name),w=y(m.name),$=M(m.name);return e("div",{class:"card",style:{padding:"1rem",cursor:"pointer",borderColor:l===m.name?"var(--accent)":void 0,transition:"all 0.2s ease"},onClick:()=>u(l===m.name?"":m.name),children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:`linear-gradient(135deg, ${w}20, ${w}40)`,border:`2px solid ${w}`,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",flexShrink:0},children:L?e("img",{src:L,alt:m.name,style:{width:"24px",height:"24px",objectFit:"contain"},onError:J=>{let Z=J.target;Z.style.display="none";let se=Z.parentElement;if(se){let Q=document.createElement("span");Q.style.fontSize="1.5rem",Q.textContent=$,se.appendChild(Q)}}}):e("span",{style:{fontSize:"1.5rem"},children:$})}),e("div",{style:{flex:1},children:[e("div",{style:{fontWeight:600,fontSize:"0.9375rem"},children:m.name}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:[m.model_count||0," model",(m.model_count||0)!==1?"s":""]})]})]}),e("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e("span",{class:`badge ${m.connected?"badge-success":"badge-error"}`,style:{fontSize:"0.6875rem"},children:m.connected?"\u25CF Connected":"\u25CB Disconnected"}),m.latency_ms&&e("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:[m.latency_ms,"ms"]})]})]},m.name)})})]}),t?.default_model&&e("div",{class:"card",style:{marginBottom:"1rem",borderColor:"var(--accent)",background:"linear-gradient(135deg, var(--accent)08, var(--accent)15)"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e("div",{style:{width:"56px",height:"56px",borderRadius:"12px",background:`linear-gradient(135deg, ${y(t.default_model.provider)}, ${y(t.default_model.provider)}CC)`,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:b(t.default_model.provider)?e("img",{src:b(t.default_model.provider),alt:t.default_model.provider,style:{width:"32px",height:"32px",objectFit:"contain",filter:"brightness(0) invert(1)"},onError:m=>{m.target.style.display="none"}}):e("span",{style:{fontSize:"1.75rem"},children:M(t.default_model.provider)})}),e("div",{style:{flex:1},children:[e("div",{style:{fontSize:"0.75rem",color:"var(--accent)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em"},children:"\u2B50 Default Model"}),e("div",{style:{fontSize:"1.25rem",fontWeight:700,marginTop:"0.125rem"},children:t.default_model.label}),e("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.125rem"},children:[t.default_model.provider," \u2022 ",e("code",{style:{background:"var(--bg-hover)",padding:"0.125rem 0.375rem",borderRadius:"4px",fontSize:"0.75rem"},children:t.default_model.value})]})]}),e("button",{class:"btn btn-primary",onClick:()=>H(t.default_model.value),style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:"\u{1F4AC} Test"})]})}),e("div",{class:"filter-bar",style:{marginBottom:"1rem"},children:[e("input",{type:"text",class:"filter-input",placeholder:"Search models...",value:i,onInput:m=>c(m.target.value),style:{flex:1}}),e("select",{class:"filter-select",value:l,onChange:m=>u(m.target.value),children:[e("option",{value:"",children:"All Providers"}),k.map(m=>e("option",{value:m,children:m},m))]}),e("button",{class:"btn btn-secondary",onClick:()=>{c(""),u("")},style:{fontSize:"0.75rem",padding:"0.4rem 0.6rem"},children:"Clear"})]}),e("div",{style:{marginBottom:"0.75rem",fontSize:"0.8125rem",color:"var(--text-secondary)"},children:["Showing ",U.length," of ",t?.models?.length||0," models"]}),e("div",{style:{display:"grid",gap:"0.75rem"},children:U.length===0?e("div",{class:"card",style:{textAlign:"center",padding:"3rem"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"0.5rem",opacity:.5},children:"\u{1F52E}"}),e("div",{style:{color:"var(--text-secondary)"},children:t?.models?.length===0?"No models available":"No models match your search"})]}):U.map(m=>{let L=b(m.provider),w=y(m.provider),$=M(m.provider);return e("div",{class:"card",style:{padding:"1rem"},children:e("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[e("div",{style:{width:"44px",height:"44px",borderRadius:"10px",background:`linear-gradient(135deg, ${w}15, ${w}30)`,border:`1px solid ${w}50`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:L?e("img",{src:L,alt:m.provider,style:{width:"26px",height:"26px",objectFit:"contain"},onError:J=>{let Z=J.target;Z.style.display="none";let se=Z.parentElement;if(se){let Q=document.createElement("span");Q.style.fontSize="1.5rem",Q.textContent=$,se.appendChild(Q)}}}):e("span",{style:{fontSize:"1.5rem"},children:$})}),e("div",{style:{flex:1,minWidth:0},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem",flexWrap:"wrap"},children:[e("span",{style:{fontWeight:600,fontSize:"0.9375rem"},children:m.label}),m.recommended&&e("span",{class:"badge badge-success",style:{fontSize:"0.625rem",padding:"0.125rem 0.375rem"},children:"\u2B50 Recommended"}),!m.enabled&&e("span",{class:"badge badge-warning",style:{fontSize:"0.625rem",padding:"0.125rem 0.375rem"},children:"Disabled"})]}),e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.5rem"},children:[e("code",{style:{background:"var(--bg-hover)",padding:"0.125rem 0.375rem",borderRadius:"4px",fontSize:"0.6875rem"},children:m.value}),e("span",{style:{margin:"0 0.5rem",color:"var(--border)"},children:"\u2022"}),e("span",{style:{color:w,fontWeight:500},children:m.provider})]}),m.capabilities&&Object.keys(m.capabilities).length>0&&e("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem"},children:[Object.entries(m.capabilities).slice(0,p.has(m.id)?void 0:4).map(([J,Z])=>Z===!0||Z==="true"?e("span",{class:"badge badge-info",style:{fontSize:"0.5625rem",padding:"0.125rem 0.375rem",textTransform:"capitalize"},children:J.replace(/_/g," ")},J):null),Object.keys(m.capabilities).filter(J=>m.capabilities[J]===!0||m.capabilities[J]==="true").length>4&&!p.has(m.id)&&e("span",{class:"badge",style:{fontSize:"0.5625rem",padding:"0.125rem 0.375rem",cursor:"pointer"},onClick:()=>T(m.id),children:["+",Object.keys(m.capabilities).filter(J=>m.capabilities[J]===!0||m.capabilities[J]==="true").length-4," more"]})]}),p.has(m.id)&&m.capabilities&&e("div",{style:{marginTop:"0.75rem",padding:"0.75rem",background:"var(--bg-hover)",borderRadius:"6px"},children:[e("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.5rem",fontWeight:600,textTransform:"uppercase"},children:"Full Capabilities"}),e("pre",{style:{fontSize:"0.625rem",margin:0,overflow:"auto",maxHeight:"200px"},children:JSON.stringify(m.capabilities,null,2)})]})]}),e("div",{style:{display:"flex",gap:"0.375rem",flexShrink:0},children:[e("button",{class:"btn btn-primary",style:{padding:"0.375rem 0.75rem",fontSize:"0.75rem"},onClick:()=>H(m.value),title:"Test chat completion",children:"\u{1F4AC} Test"}),e("button",{class:"btn btn-secondary",style:{padding:"0.375rem 0.5rem",fontSize:"0.75rem"},onClick:()=>T(m.id),title:"View details",children:p.has(m.id)?"\u25BC":"\u25B6"})]})]})},m.id)})}),t?.last_updated&&e("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center"},children:["Last updated: ",new Date(t.last_updated).toLocaleString(),t.cached_until&&e("span",{children:[" \u2022 Cached until: ",new Date(t.cached_until).toLocaleString()]})]})]})}function $t(){let[t,r]=x([]),[n,a]=x(""),[o,s]=x(!0),[i,c]=x(!1),[l,u]=x(null),[p,d]=x(null),[h,S]=x(""),[C,R]=x(""),[E,v]=x(!1),[g,I]=x(""),[P,B]=x(""),[W,G]=x(null),[T,f]=x(""),b=async()=>{s(!0),u(null);try{let $=await(await fetch("/api/env")).json();r($.variables||[]),a($.env_file||"")}catch(w){u(`Failed to fetch environment variables: ${w}`)}finally{s(!1)}};N(()=>{b()},[]);let y=async()=>{c(!0),u(null),d(null);try{let $=await(await fetch("/api/env/save",{method:"POST"})).json();$.success?d("Environment saved to .env file"):u($.message||"Failed to save")}catch(w){u(`Failed to save: ${w}`)}finally{c(!1)}},M=async()=>{c(!0),u(null),d(null);try{let $=await(await fetch("/api/env/reload",{method:"POST"})).json();$.success?(d("Environment reloaded from .env file"),b()):u($.message||"Failed to reload")}catch(w){u(`Failed to reload: ${w}`)}finally{c(!1)}},D=async()=>{if(!g.trim()){u("Key is required");return}c(!0),u(null);try{let $=await(await fetch("/api/env",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:{[g]:P},save_to_file:!0})})).json();$.success?(d("Variable added"),I(""),B(""),v(!1),b()):u($.message||"Failed to add variable")}catch(w){u(`Failed to add: ${w}`)}finally{c(!1)}},H=async(w,$)=>{c(!0),u(null);try{let Z=await(await fetch("/api/env",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:{[w]:$},save_to_file:!0})})).json();Z.success?(d(`Updated ${w}`),G(null),b()):u(Z.message||"Failed to update")}catch(J){u(`Failed to update: ${J}`)}finally{c(!1)}},j=w=>{w.editable&&(G(w.key),f(w.value))},U=()=>{G(null),f("")},k=w=>{let J={custom:{class:"badge-success",label:"Custom"},worker:{class:"badge-info",label:"Worker"},inherited:{class:"badge-warning",label:"Inherited"},system:{class:"badge",label:"System"}}[w]||{class:"badge",label:w};return e("span",{class:`badge ${J.class}`,style:{fontSize:"0.625rem"},children:J.label})},_=t.filter(w=>!(h&&!w.key.toLowerCase().includes(h.toLowerCase())||C&&w.source!==C)),m=_.filter(w=>w.source==="custom"||w.source==="worker"),L=_.filter(w=>w.source!=="custom"&&w.source!=="worker");return o&&t.length===0?e("div",{class:"card",children:e("div",{style:{textAlign:"center",padding:"3rem"},children:[e("span",{class:"spinner",style:{width:"32px",height:"32px"}}),e("div",{style:{marginTop:"1rem",color:"var(--text-secondary)"},children:"Loading environment variables..."})]})}):e(A,{children:[e("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"Environment Variables"}),e("div",{style:{display:"flex",gap:"0.5rem"},children:[e("button",{class:"btn btn-primary",onClick:()=>v(!0),children:"+ Add Variable"}),e("button",{class:"btn btn-secondary",onClick:M,disabled:i,children:"\u21BB Reload"}),e("button",{class:"btn btn-secondary",onClick:y,disabled:i,children:"\u{1F4BE} Save to .env"})]})]}),l&&e("div",{class:"card",style:{borderColor:"var(--error)",marginBottom:"1rem",padding:"0.75rem"},children:e("div",{style:{color:"var(--error)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{children:"\u274C"}),e("span",{children:l}),e("button",{style:{marginLeft:"auto",background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer"},onClick:()=>u(null),children:"\u2715"})]})}),p&&e("div",{class:"card",style:{borderColor:"var(--success)",marginBottom:"1rem",padding:"0.75rem"},children:e("div",{style:{color:"var(--success)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e("span",{children:"\u2713"}),e("span",{children:p}),e("button",{style:{marginLeft:"auto",background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer"},onClick:()=>d(null),children:"\u2715"})]})}),e("div",{class:"card",style:{borderColor:"var(--warning)",marginBottom:"1rem",padding:"0.75rem",background:"rgba(255, 193, 7, 0.1)"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e("span",{children:"\u26A0\uFE0F"}),e("span",{children:"Changes to environment variables require worker restart to take effect."})]})}),n&&e("div",{style:{marginBottom:"1rem",fontSize:"0.8125rem",color:"var(--text-secondary)"},children:[e("span",{style:{fontWeight:500},children:".env file:"})," ",e("code",{style:{background:"var(--bg-hover)",padding:"0.125rem 0.375rem",borderRadius:"3px"},children:n})]}),E&&e("div",{class:"card",style:{marginBottom:"1rem"},children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:"Add Environment Variable"})}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e("div",{children:[e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Key"}),e("input",{type:"text",class:"filter-input",style:{width:"100%"},value:g,onInput:w=>I(w.target.value.toUpperCase().replace(/[^A-Z0-9_]/g,"_")),placeholder:"MY_VARIABLE"})]}),e("div",{children:[e("label",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Value"}),e("input",{type:"text",class:"filter-input",style:{width:"100%"},value:P,onInput:w=>B(w.target.value),placeholder:"value"})]}),e("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e("button",{class:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"}),e("button",{class:"btn btn-primary",onClick:D,disabled:i,children:i?"Adding...":"Add"})]})]})]}),e("div",{class:"filter-bar",style:{marginBottom:"1rem"},children:[e("input",{type:"text",class:"filter-input",placeholder:"Search variables...",value:h,onInput:w=>S(w.target.value),style:{flex:1}}),e("select",{class:"filter-select",value:C,onChange:w=>R(w.target.value),children:[e("option",{value:"",children:"All Sources"}),e("option",{value:"custom",children:"Custom"}),e("option",{value:"worker",children:"Worker"}),e("option",{value:"inherited",children:"Inherited"}),e("option",{value:"system",children:"System"})]}),e("button",{class:"btn btn-secondary",onClick:()=>{S(""),R("")},style:{fontSize:"0.75rem",padding:"0.4rem 0.6rem"},children:"Clear"})]}),m.length>0&&e("div",{class:"card",style:{marginBottom:"1rem"},children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:["Custom & Worker Variables (",m.length,")"]})}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:m.map(w=>e("div",{style:{padding:"0.75rem",background:"var(--bg-hover)",borderRadius:"6px",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("div",{style:{flex:1},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e("span",{style:{fontFamily:"monospace",fontWeight:500},children:w.key}),k(w.source),w.sensitive&&e("span",{class:"badge badge-warning",style:{fontSize:"0.625rem"},children:"Sensitive"})]}),W===w.key?e("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e("input",{type:w.sensitive?"password":"text",class:"filter-input",style:{flex:1,padding:"0.375rem"},value:T,onInput:$=>f($.target.value),onKeyDown:$=>{$.key==="Enter"&&H(w.key,T),$.key==="Escape"&&U()},autoFocus:!0}),e("button",{class:"btn btn-primary",style:{padding:"0.25rem 0.5rem"},onClick:()=>H(w.key,T),children:"Save"}),e("button",{class:"btn btn-secondary",style:{padding:"0.25rem 0.5rem"},onClick:U,children:"Cancel"})]}):e("div",{style:{fontFamily:"monospace",fontSize:"0.8125rem",color:"var(--text-secondary)",cursor:w.editable?"pointer":"default"},onClick:()=>j(w),title:w.editable?"Click to edit":"",children:w.value})]}),w.editable&&W!==w.key&&e("button",{class:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},onClick:()=>j(w),children:"Edit"})]},w.key))})]}),L.length>0&&e("div",{class:"card",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:["System & Inherited Variables (",L.length,")"]})}),e("div",{style:{maxHeight:"400px",overflow:"auto"},children:e("table",{class:"table",children:[e("thead",{children:e("tr",{children:[e("th",{children:"Key"}),e("th",{children:"Value"}),e("th",{children:"Source"})]})}),e("tbody",{children:L.map(w=>e("tr",{children:[e("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:w.key}),e("td",{style:{fontFamily:"monospace",fontSize:"0.75rem",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis"},children:w.value}),e("td",{children:k(w.source)})]},w.key))})]})})]}),_.length===0&&e("div",{class:"card",style:{textAlign:"center",padding:"3rem"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"0.5rem",opacity:.5},children:"\u{1F527}"}),e("div",{style:{color:"var(--text-secondary)"},children:t.length===0?"No environment variables found":"No variables match your search"})]}),e("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center"},children:["Total: ",t.length," variables (",t.filter(w=>w.source==="custom").length," custom,",t.filter(w=>w.source==="worker").length," worker,",t.filter(w=>w.source==="inherited").length," inherited,",t.filter(w=>w.source==="system").length," system)"]})]})}var Ve=t=>{try{let r=typeof t=="string"?JSON.parse(t):t,n=JSON.stringify(r,null,2);return e("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:n})}catch{return e("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:t})}},pe=(t,r=100)=>t?t.length<=r?t:t.slice(0,r)+"...":"",me=t=>{try{return new Date(t).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}};function Vt({events:t,isRunning:r,onClear:n}){let[a,o]=x({}),[s,i]=x("stream"),[c,l]=x(!0),u=V(null),p=V(null);N(()=>{c&&p.current&&p.current.scrollIntoView({behavior:"smooth"})},[t,c]);let d=f=>{o(b=>({...b,[f]:{expanded:!b[f]?.expanded}}))},h=t.reduce((f,b)=>{if(b.type==="text"){let y=f[f.length-1];y&&"type"in y&&y.type==="text_group"?y.events.push(b):f.push({type:"text_group",events:[b]})}else if(b.type==="output"){let y=-1,M=!1;for(let D=f.length-1;D>=0;D--){let H=f[D];if("type"in H&&H.type==="output"){y=D;break}if("type"in H&&(H.type==="tool_pair"||H.type==="tool_call")){M=!0;break}}if(y>=0&&!M){let D=f[y];D.content=(D.content||"")+(b.content||"")}else f.push({...b})}else if(b.type==="tool_call")f.push({type:"tool_pair",call:b});else if(b.type==="tool_result"){let y=!1;for(let M=f.length-1;M>=0;M--){let D=f[M];if("type"in D&&D.type==="tool_pair"){let H=D;if(!H.result)if(b.tool_call_id&&H.call.tool_call_id){if(H.call.tool_call_id===b.tool_call_id){H.result=b,y=!0;break}}else{H.result=b,y=!0;break}}}y||f.push(b)}else f.push(b);return f},[]),S=(f,b,y)=>{let M=a[y]?.expanded??!1,D=f.tool_input&&f.tool_input.length>0,H=b?.tool_output&&b.tool_output.length>0,j=b?!b.content?.toLowerCase().includes("error"):!0,U=!b,k="";if(D)try{let m=JSON.parse(f.tool_input);m.command?k=m.command.length>60?m.command.slice(0,60)+"...":m.command:m.file_path?k=m.file_path:m.pattern?k=m.pattern:k=pe(f.tool_input,60)}catch{k=pe(f.tool_input,60)}let _="";return H&&(_=pe(b.tool_output,80)),e("div",{style:{background:"var(--bg-hover)",borderRadius:"8px",overflow:"hidden",border:"1px solid var(--border)",borderLeft:b?`3px solid ${j?"var(--success)":"var(--error)"}`:"3px solid var(--accent)"},children:[e("div",{style:{padding:"0.625rem 0.875rem",display:"flex",alignItems:"center",gap:"0.5rem",cursor:D||H?"pointer":"default",userSelect:"none"},onClick:()=>(D||H)&&d(y),children:[e("span",{style:{width:"24px",height:"24px",borderRadius:"6px",background:U?"var(--accent)":j?"var(--success)":"var(--error)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",flexShrink:0,color:"white"},children:U?e("span",{class:"spinner spinner-sm",style:{width:12,height:12}}):j?"\u2713":"\u2717"}),e("div",{style:{flex:1,minWidth:0},children:[e("div",{style:{fontWeight:600,fontSize:"0.8125rem",color:"var(--text-primary)",display:"flex",alignItems:"center",gap:"0.5rem"},children:f.tool_name||"Tool"}),!M&&k&&e("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace'},children:k})]}),b?.duration_ms&&e("span",{style:{fontSize:"0.625rem",color:"var(--text-muted)",flexShrink:0,padding:"0.125rem 0.375rem",background:"var(--bg-primary)",borderRadius:"4px"},children:[b.duration_ms,"ms"]}),e("span",{style:{fontSize:"0.625rem",color:"var(--text-muted)",flexShrink:0},children:me(f.timestamp)}),(D||H)&&e("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",transform:M?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s",flexShrink:0},children:"\u25BC"})]}),M&&e("div",{style:{borderTop:"1px solid var(--border)"},children:[D&&e("div",{style:{padding:"0.625rem 0.875rem",background:"var(--bg-primary)"},children:[e("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginBottom:"0.375rem",textTransform:"uppercase",fontWeight:600},children:"Input"}),e("pre",{style:{margin:0,fontSize:"0.6875rem",fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace',color:"var(--text-secondary)",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"150px",overflow:"auto"},children:Ve(f.tool_input)})]}),H&&e("div",{style:{padding:"0.625rem 0.875rem",background:"var(--bg-secondary)",borderTop:D?"1px solid var(--border)":"none"},children:[e("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginBottom:"0.375rem",textTransform:"uppercase",fontWeight:600},children:"Output"}),e("pre",{style:{margin:0,fontSize:"0.6875rem",fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace',color:"var(--text-secondary)",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"200px",overflow:"auto"},children:Ve(b.tool_output)})]})]})]},y)},C=(f,b)=>S(f,void 0,b),R=(f,b)=>{let y=a[b]?.expanded??!1,M=f.tool_output&&f.tool_output.length>0,D=M?pe(f.tool_output,100):f.content||"Success",H=!f.content?.toLowerCase().includes("error");return e("div",{style:{background:H?"rgba(16, 185, 129, 0.08)":"rgba(239, 68, 68, 0.08)",borderRadius:"8px",overflow:"hidden",borderLeft:`3px solid ${H?"var(--success)":"var(--error)"}`},children:[e("div",{style:{padding:"0.625rem 0.875rem",display:"flex",alignItems:"center",gap:"0.5rem",cursor:M?"pointer":"default"},onClick:()=>M&&d(b),children:[e("span",{style:{fontSize:"0.875rem",flexShrink:0},children:H?"\u2713":"\u2717"}),e("div",{style:{flex:1,minWidth:0},children:e("div",{style:{fontSize:"0.75rem",color:H?"var(--success)":"var(--error)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y?"Result":D})}),f.duration_ms&&e("span",{style:{fontSize:"0.625rem",color:"var(--text-muted)",flexShrink:0},children:[f.duration_ms,"ms"]}),M&&e("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",transform:y?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s",flexShrink:0},children:"\u25BC"})]}),y&&M&&e("div",{style:{padding:"0.75rem",borderTop:"1px solid var(--border)",background:"var(--bg-primary)",maxHeight:"300px",overflow:"auto"},children:e("pre",{style:{margin:0,fontSize:"0.6875rem",fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace',color:"var(--text-secondary)",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:Ve(f.tool_output)})})]},b)},E=(f,b)=>e("div",{style:{padding:"0.625rem 0.875rem",background:"rgba(139, 92, 246, 0.08)",borderRadius:"8px",borderLeft:"3px solid #8B5CF6",display:"flex",gap:"0.5rem"},children:[e("span",{style:{flexShrink:0},children:"\u{1F4AD}"}),e("div",{style:{flex:1,minWidth:0},children:e("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",fontStyle:"italic",lineHeight:1.5},children:f.content})}),e("span",{style:{fontSize:"0.625rem",color:"var(--text-muted)",flexShrink:0},children:me(f.timestamp)})]},b),v=(f,b)=>{let[y,M]=x(!1),D=f.content.split(`
`).filter(U=>U.trim()),H=D.slice(0,3),j=D.length>3;return e("div",{style:{background:"rgba(59, 130, 246, 0.08)",borderRadius:"8px",borderLeft:"3px solid #3B82F6",overflow:"hidden"},children:e("div",{style:{padding:"0.625rem 0.875rem",cursor:j?"pointer":"default"},onClick:()=>j&&M(!y),children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e("span",{children:"\u{1F4CB}"}),e("span",{style:{fontWeight:600,fontSize:"0.8125rem",color:"#3B82F6"},children:"Execution Plan"}),j&&e("span",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginLeft:"auto"},children:y?"\u25B2 Collapse":`\u25BC +${D.length-3} more`})]}),e("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:(y?D:H).map((U,k)=>e("div",{style:{padding:"0.125rem 0"},children:U},k))})]})},b)},g=(f,b)=>{let y={starting:"\u{1F680}",running:"\u23F3",complete:"\u2705",stopped:"\u23F9",cancelled:"\u{1F6AB}"};return e("div",{style:{padding:"0.5rem 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[f.status==="starting"&&r?e("span",{class:"spinner",style:{width:12,height:12}}):e("span",{children:y[f.status||""]||"\u2022"}),e("span",{children:f.content}),e("span",{style:{marginLeft:"auto",fontSize:"0.625rem"},children:me(f.timestamp)})]},b)},I=(f,b)=>{let y=f.map(j=>j.content).join(`
`),M=y.split(`
`),[D,H]=x(M.length<=10);return e("div",{style:{background:"var(--bg-hover)",borderRadius:"6px",overflow:"hidden"},children:[e("pre",{style:{margin:0,padding:"0.625rem 0.875rem",fontSize:"0.75rem",fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace',color:"var(--text-secondary)",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:D?"none":"120px",overflow:D?"visible":"hidden",lineHeight:1.5},children:y}),M.length>10&&e("div",{style:{padding:"0.375rem 0.875rem",borderTop:"1px solid var(--border)",fontSize:"0.6875rem",color:"var(--text-muted)",cursor:"pointer",textAlign:"center"},onClick:()=>H(!D),children:D?"\u25B2 Collapse":`\u25BC Show all ${M.length} lines`})]},b)},P=(f,b)=>e("div",{style:{padding:"0.875rem",background:"linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(139, 92, 246, 0.05))",borderRadius:"8px",borderLeft:"3px solid #6366F1"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e("span",{style:{width:"24px",height:"24px",borderRadius:"6px",background:"linear-gradient(135deg, #6366F1, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem"},children:"\u{1F916}"}),e("span",{style:{fontWeight:600,color:"#A78BFA",fontSize:"0.8125rem"},children:"Agent Response"}),e("span",{style:{marginLeft:"auto",fontSize:"0.625rem",color:"var(--text-muted)"},children:me(f.timestamp)})]}),e("div",{style:{fontSize:"0.875rem",color:"var(--text-primary)",lineHeight:1.6,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:f.content})]},b),B=(f,b)=>e("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--error)"},children:[e("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e("span",{children:"\u274C"}),e("span",{style:{fontWeight:600,color:"var(--error)",fontSize:"0.8125rem"},children:"Error"})]}),e("div",{style:{fontSize:"0.8125rem",color:"var(--error)",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:f.content})]},b),W=(f,b)=>e("div",{style:{padding:"0.875rem",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05))",borderRadius:"8px",border:"1px solid rgba(16, 185, 129, 0.3)",textAlign:"center"},children:[e("div",{style:{fontSize:"1.5rem",marginBottom:"0.375rem"},children:"\u{1F389}"}),e("div",{style:{fontWeight:600,color:"var(--success)",fontSize:"0.9375rem"},children:"Execution Complete"}),f.content&&e("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:f.content})]},b),G=(f,b)=>{if("type"in f){if(f.type==="text_group")return I(f.events,b);if(f.type==="tool_pair"){let M=f;return S(M.call,M.result,b)}}let y=f;switch(y.type){case"tool_call":return C(y,b);case"tool_result":return R(y,b);case"reasoning":case"thinking":return E(y,b);case"plan":return v(y,b);case"status":return g(y,b);case"error":return B(y,b);case"done":return W(y,b);case"output":return P(y,b);case"text":return I([y],b);default:return null}},T=()=>e("div",{style:{fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace',fontSize:"0.6875rem"},children:e("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e("thead",{children:e("tr",{style:{borderBottom:"1px solid var(--border)",position:"sticky",top:0,background:"var(--bg-secondary)"},children:[e("th",{style:{padding:"0.5rem",textAlign:"left",width:"70px",color:"var(--text-muted)"},children:"Time"}),e("th",{style:{padding:"0.5rem",textAlign:"left",width:"80px",color:"var(--text-muted)"},children:"Type"}),e("th",{style:{padding:"0.5rem",textAlign:"left",color:"var(--text-muted)"},children:"Content"})]})}),e("tbody",{children:t.map((f,b)=>e("tr",{style:{borderBottom:"1px solid var(--border)",background:f.type==="error"?"rgba(239, 68, 68, 0.05)":void 0},children:[e("td",{style:{padding:"0.375rem 0.5rem",color:"var(--text-muted)",whiteSpace:"nowrap"},children:me(f.timestamp)}),e("td",{style:{padding:"0.375rem 0.5rem"},children:e("span",{style:{padding:"0.125rem 0.375rem",borderRadius:"4px",fontSize:"0.625rem",background:f.type==="tool_call"?"rgba(139, 92, 246, 0.2)":f.type==="tool_result"?"rgba(16, 185, 129, 0.2)":f.type==="error"?"rgba(239, 68, 68, 0.2)":f.type==="reasoning"?"rgba(139, 92, 246, 0.15)":"var(--bg-hover)",color:f.type==="tool_call"?"#A78BFA":f.type==="tool_result"?"var(--success)":f.type==="error"?"var(--error)":f.type==="reasoning"?"#C4B5FD":"var(--text-secondary)"},children:f.type})}),e("td",{style:{padding:"0.375rem 0.5rem",color:"var(--text-secondary)",maxWidth:"400px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[f.tool_name?`[${f.tool_name}] `:"",pe(f.content||f.tool_input||f.tool_output||"",100)]})]},b))})]})});return e("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e("div",{style:{padding:"0.5rem 0.75rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[e("div",{style:{display:"flex",borderRadius:"6px",overflow:"hidden",border:"1px solid var(--border)"},children:[e("button",{style:{padding:"0.25rem 0.625rem",fontSize:"0.6875rem",border:"none",background:s==="stream"?"var(--accent)":"transparent",color:s==="stream"?"white":"var(--text-secondary)",cursor:"pointer"},onClick:()=>i("stream"),children:"Stream"}),e("button",{style:{padding:"0.25rem 0.625rem",fontSize:"0.6875rem",border:"none",borderLeft:"1px solid var(--border)",background:s==="logs"?"var(--accent)":"transparent",color:s==="logs"?"white":"var(--text-secondary)",cursor:"pointer"},onClick:()=>i("logs"),children:"Logs"})]}),e("div",{style:{flex:1}}),e("label",{style:{display:"flex",alignItems:"center",gap:"0.375rem",fontSize:"0.6875rem",color:"var(--text-muted)",cursor:"pointer"},children:[e("input",{type:"checkbox",checked:c,onChange:f=>l(f.target.checked),style:{width:"12px",height:"12px"}}),"Auto-scroll"]}),e("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:[t.length," events"]}),n&&e("button",{style:{padding:"0.25rem 0.5rem",fontSize:"0.6875rem",border:"1px solid var(--border)",borderRadius:"4px",background:"transparent",color:"var(--text-secondary)",cursor:"pointer"},onClick:n,children:"Clear"})]}),e("div",{ref:u,style:{flex:1,overflow:"auto",padding:s==="stream"?"0.75rem":0},children:t.length===0?e("div",{style:{textAlign:"center",padding:"3rem",color:"var(--text-muted)"},children:[e("div",{style:{fontSize:"2rem",marginBottom:"0.5rem",opacity:.5},children:"\u{1F4E1}"}),e("div",{style:{fontSize:"0.875rem"},children:"Waiting for events..."})]}):s==="stream"?e("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.map((f,b)=>G(f,b)),e("div",{ref:p})]}):T()}),r&&e("div",{style:{padding:"0.5rem 0.75rem",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",color:"var(--accent)",background:"rgba(99, 102, 241, 0.05)",flexShrink:0},children:[e("span",{class:"spinner",style:{width:12,height:12}}),e("span",{children:"Execution in progress..."})]})]})}function ke({size:t=32,className:r="",style:n="kubiya"}){return n==="fragments"?e("svg",{width:t,height:t,viewBox:"0 0 232 232",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:r,children:e("path",{d:"M230.85 113.23L193.6 75.9799C192.87 75.2399 191.87 74.8299 190.83 74.8299H162.56C159.13 74.8299 157.17 72.8699 157.17 69.4399V41.1599C157.17 40.1199 156.76 39.1199 156.02 38.3899L118.77 1.14994C117.24 -0.380059 114.76 -0.380059 113.23 1.14994L75.9799 38.3999C75.2399 39.1399 74.8299 40.1299 74.8299 41.1699V69.4399C74.8299 72.8699 72.8699 74.8299 69.4399 74.8299H41.1699C40.1299 74.8299 39.1299 75.2399 38.3999 75.9799L1.14994 113.23C-0.380059 114.76 -0.380059 117.24 1.14994 118.77L38.3999 156.02C39.1399 156.75 40.1299 157.17 41.1699 157.17H69.4599C72.8799 157.17 74.8399 159.13 74.8399 162.56V190.83C74.8399 191.87 75.2499 192.87 75.9899 193.6L113.24 230.85C114.77 232.38 117.25 232.38 118.78 230.85L156.03 193.6C156.76 192.87 157.18 191.87 157.18 190.83V162.54C157.18 159.12 159.14 157.16 162.57 157.16H190.84C191.88 157.16 192.88 156.75 193.61 156.01L230.86 118.76C232.39 117.23 232.39 114.75 230.86 113.21L230.85 113.23ZM189.68 118.77L151.28 157.16L118.76 189.68C117.23 191.21 114.75 191.21 113.22 189.68L74.8199 151.28L42.2999 118.77C40.7699 117.24 40.7699 114.76 42.2999 113.22L80.6999 74.8199L113.22 42.2999C114.75 40.7699 117.23 40.7699 118.76 42.2999L157.16 80.6999L189.67 113.22C191.2 114.75 191.2 117.23 189.67 118.77H189.68Z",fill:"currentColor"})}):e("svg",{width:t,height:t,viewBox:"0 0 224 232",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:r,children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M188.212 157.998C186.672 157.998 185.71 159.665 186.48 160.998L202.585 188.894C203.476 190.437 202.056 192.287 200.335 191.826L151.491 178.737C149.357 178.165 147.163 179.432 146.592 181.566L133.504 230.411C133.042 232.132 130.731 232.436 129.84 230.893L113.732 202.992C112.962 201.659 111.037 201.659 110.268 202.992L94.1595 230.893C93.2686 232.436 90.9568 232.132 90.4956 230.411L77.4075 181.566C76.8357 179.432 74.6423 178.165 72.5085 178.737L23.664 191.826C21.9429 192.287 20.5234 190.437 21.4143 188.894L37.5192 160.998C38.289 159.665 37.3267 157.998 35.7871 157.998L3.57893 157.998C1.79713 157.998 0.904821 155.844 2.16476 154.584L37.9218 118.827C39.484 117.265 39.484 114.733 37.9218 113.171L2.16478 77.4133C0.904844 76.1533 1.7972 73.999 3.57902 73.9991L35.7837 73.9995C37.3233 73.9995 38.2856 72.3328 37.5158 70.9995L21.4143 43.11C20.5234 41.5669 21.9429 39.717 23.664 40.1781L72.5085 53.2665C74.6423 53.8383 76.8357 52.572 77.4075 50.4381L90.4956 1.59292C90.9568 -0.128187 93.2686 -0.432531 94.1595 1.11058L110.267 29.0111C111.037 30.3445 112.962 30.3445 113.732 29.0111L129.84 1.11058C130.73 -0.432532 133.042 -0.128189 133.503 1.59292L146.592 50.4381C147.163 52.572 149.357 53.8383 151.491 53.2665L200.335 40.1781C202.056 39.717 203.476 41.5669 202.585 43.11L186.483 70.9995C185.713 72.3328 186.676 73.9995 188.215 73.9995L220.421 73.9991C222.203 73.999 223.095 76.1533 221.835 77.4133L186.078 113.171C184.516 114.733 184.516 117.265 186.078 118.827L221.835 154.584C223.095 155.844 222.203 157.998 220.421 157.998L188.212 157.998ZM175.919 81.3306C177.366 79.8837 175.963 77.4549 173.987 77.9845L130.491 89.6396C128.357 90.2114 126.164 88.9451 125.592 86.8112L113.931 43.293C113.402 41.3166 110.597 41.3166 110.068 43.293L98.4069 86.8112C97.8351 88.9451 95.6418 90.2114 93.5079 89.6396L50.0136 77.9849C48.0371 77.4553 46.6348 79.8841 48.0817 81.331L79.9216 113.171C81.4837 114.733 81.4837 117.266 79.9216 118.828L48.0742 150.675C46.6273 152.122 48.0296 154.55 50.0061 154.021L93.5079 142.364C95.6418 141.792 97.8351 143.059 98.4069 145.192L110.068 188.711C110.597 190.687 113.402 190.687 113.931 188.711L125.592 145.192C126.164 143.059 128.357 141.792 130.491 142.364L173.994 154.021C175.971 154.551 177.373 152.122 175.926 150.675L144.079 118.828C142.516 117.266 142.516 114.733 144.079 113.171L175.919 81.3306Z",fill:"currentColor"})})}function jt({size:t=24}){return e("div",{style:{width:t,height:t,borderRadius:"6px",background:"linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary) / 0.7))",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e(ke,{size:t*.6})})}function Ut(){let[t,r]=x([]),[n,a]=x([]),[o,s]=x([]),[i,c]=x(!0),[l,u]=x({prompt:"",mode:"auto",entityId:void 0,local:!0,directApi:!1,environment:void 0,workingDir:"",streamFormat:"json",verbose:!1}),[p,d]=x(!1),[h,S]=x([]),[C,R]=x(null),[E,v]=x(null),[g,I]=x(!0),P=V(null);N(()=>(B(),()=>{P.current&&P.current.close()}),[]);let B=async()=>{c(!0);try{let[y,M,D]=await Promise.all([fetch("/api/exec/agents"),fetch("/api/exec/teams"),fetch("/api/exec/environments")]),[H,j,U]=await Promise.all([y.json().catch(()=>({agents:[]})),M.json().catch(()=>({teams:[]})),D.json().catch(()=>({environments:[]}))]);r(H.agents||[]),a(j.teams||[]),s(U.environments||[])}catch(y){console.error("Failed to fetch resources:",y)}finally{c(!1)}},W=async()=>{if(!l.prompt.trim()){v("Please enter a prompt");return}if(l.directApi&&l.mode!=="agent"){v("Direct API mode requires selecting a specific agent");return}if(l.directApi&&!l.entityId){v("Please select an agent for direct API mode");return}d(!0),S([]),v(null),R(null),I(!1);let y=l.directApi?"Submitting to control plane API...":l.local?"Starting local execution...":"Starting execution...";T({type:"status",content:y,timestamp:new Date().toISOString(),status:"starting"});try{let M=l.directApi?"/api/exec/direct/start":"/api/exec/start",D=l.directApi?"/api/exec/direct/stream":"/api/exec/stream",H=await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),j=await H.json();if(!H.ok)throw new Error(j.error||"Failed to start execution");R(j.execution_id);let U=new EventSource(`${D}/${j.execution_id}`);P.current=U,U.onmessage=k=>{try{let _=JSON.parse(k.data);T(_),(_.type==="done"||_.type==="error")&&(U.close(),d(!1))}catch{T({type:"text",content:k.data,timestamp:new Date().toISOString()})}},U.onerror=()=>{U.close(),d(!1),T({type:"error",content:"Connection lost",timestamp:new Date().toISOString()})}}catch(M){v(M instanceof Error?M.message:"Unknown error"),d(!1),T({type:"error",content:M instanceof Error?M.message:"Unknown error",timestamp:new Date().toISOString()})}},G=async()=>{if(P.current&&P.current.close(),C)try{let y=l.directApi?`/api/exec/direct/stop/${C}`:`/api/exec/stop/${C}`;await fetch(y,{method:"POST"})}catch{}d(!1),T({type:"status",content:"Execution stopped by user",timestamp:new Date().toISOString(),status:"stopped"})},T=y=>{S(M=>[...M,y])},f=()=>{S([]),R(null),v(null)},b=()=>{f(),I(!0),u(y=>({...y,prompt:""}))};return i?e("div",{class:"card playground-loading",children:e("div",{class:"playground-loading-content",children:[e("div",{class:"playground-loading-icon",children:e(ke,{size:48})}),e("div",{class:"playground-loading-text",children:"Loading resources..."}),e("div",{class:"playground-loading-spinner",children:e("span",{class:"spinner"})})]})}):e("div",{class:"playground-container",children:[e("div",{class:"playground-header",children:[e("div",{class:"playground-header-left",children:e("div",{class:"playground-title-group",children:[e(jt,{size:32}),e("div",{children:[e("h2",{class:"playground-title",children:"Execution Playground"}),e("div",{class:"playground-subtitle",children:[e("span",{class:"playground-stat",children:[t.length," agents"]}),e("span",{class:"playground-stat-divider"}),e("span",{class:"playground-stat",children:[n.length," teams"]}),e("span",{class:"playground-stat-divider"}),e("span",{class:"playground-stat",children:[o.length," environments"]})]})]})]})}),e("div",{class:"playground-header-right",children:[!g&&!p&&e("button",{class:"btn btn-primary playground-new-btn",onClick:b,children:[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Execution"]}),e("button",{class:"btn btn-secondary playground-refresh-btn",onClick:B,disabled:i,title:"Refresh resources",children:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("path",{d:"M23 4v6h-6M1 20v-6h6"}),e("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})})]})]}),e("div",{class:"playground-main",children:[g&&e("div",{class:"card playground-config-panel",children:[e("div",{class:"card-header",children:e("h3",{class:"card-title",children:[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Configuration"]})}),e("div",{class:"playground-config-content",children:[e("div",{class:"playground-field",children:[e("label",{class:"playground-label",children:"Prompt"}),e("textarea",{class:"playground-textarea",placeholder:"What would you like to do?",value:l.prompt,onInput:y=>u({...l,prompt:y.target.value}),disabled:p})]}),e("div",{class:"playground-field",children:[e("label",{class:"playground-label",children:"Mode"}),e("div",{class:"playground-button-group",children:["auto","agent","team"].map(y=>e("button",{class:`playground-mode-btn ${l.mode===y?"active":""}`,onClick:()=>u({...l,mode:y,entityId:void 0}),disabled:p,children:[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[y==="auto"&&e(A,{children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 8v4l3 3"})]}),y==="agent"&&e(A,{children:[e("path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"}),e("path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"})]}),y==="team"&&e(A,{children:[e("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e("circle",{cx:"9",cy:"7",r:"4"}),e("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})]}),y==="auto"?"Auto":y==="agent"?"Agent":"Team"]},y))})]}),l.mode!=="auto"&&e("div",{class:"playground-field",children:[e("label",{class:"playground-label",children:l.mode==="agent"?"Select Agent":"Select Team"}),e("select",{class:"playground-select",value:l.entityId||"",onChange:y=>u({...l,entityId:y.target.value||void 0}),disabled:p,children:[e("option",{value:"",children:"Choose..."}),l.mode==="agent"?t.map(y=>e("option",{value:y.id,children:y.name},y.id)):n.map(y=>e("option",{value:y.id,children:y.name},y.id))]})]}),e("div",{class:"playground-field",children:[e("label",{class:"playground-label",children:"Location"}),e("div",{class:"playground-button-group",children:[e("button",{class:`playground-mode-btn ${l.local?"active":""}`,onClick:()=>u({...l,local:!0}),disabled:p,children:[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),e("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),e("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"Local"]}),e("button",{class:`playground-mode-btn ${l.local?"":"active"}`,onClick:()=>u({...l,local:!1}),disabled:p,children:[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("path",{d:"M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"})}),"Remote"]})]}),e("div",{class:"playground-field-hint",children:l.local?"Ephemeral local worker":"Control plane queue"})]}),l.local&&o.length>0&&e("div",{class:"playground-field",children:[e("label",{class:"playground-label",children:"Environment"}),e("select",{class:"playground-select",value:l.environment||"",onChange:y=>u({...l,environment:y.target.value||void 0}),disabled:p,children:[e("option",{value:"",children:"Auto-detect"}),o.map(y=>e("option",{value:y.id,children:y.name},y.id))]})]}),e("div",{class:"playground-field",children:[e("label",{class:"playground-label",children:"Working Directory"}),e("input",{type:"text",class:"playground-input",placeholder:"/path/to/dir (optional)",value:l.workingDir,onInput:y=>u({...l,workingDir:y.target.value}),disabled:p})]}),e("details",{class:"playground-advanced",children:[e("summary",{class:"playground-advanced-summary",children:[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("polyline",{points:"6 9 12 15 18 9"})}),"Advanced Options"]}),e("div",{class:"playground-advanced-content",children:[e("div",{class:"playground-field",style:{marginBottom:"0.75rem"},children:[e("label",{class:"playground-label",style:{fontSize:"0.75rem"},children:"Output Format"}),e("div",{class:"playground-button-group",children:[e("button",{class:`playground-mode-btn ${l.streamFormat==="text"?"active":""}`,onClick:()=>u({...l,streamFormat:"text"}),disabled:p,style:{fontSize:"0.6875rem",padding:"0.25rem 0.5rem"},children:"Text"}),e("button",{class:`playground-mode-btn ${l.streamFormat==="json"?"active":""}`,onClick:()=>u({...l,streamFormat:"json"}),disabled:p,style:{fontSize:"0.6875rem",padding:"0.25rem 0.5rem"},children:"JSON"})]}),e("div",{class:"playground-field-hint",style:{fontSize:"0.6875rem",marginTop:"0.25rem"},children:l.streamFormat==="json"?"Structured events with tool calls (recommended)":"Plain text output"})]}),e("label",{class:"playground-checkbox",children:[e("input",{type:"checkbox",checked:l.directApi,onChange:y=>u({...l,directApi:y.target.checked,mode:y.target.checked?"agent":l.mode}),disabled:p}),e("span",{class:"playground-checkbox-label",children:"Direct API (reliable streaming)"})]}),l.directApi&&e("div",{class:"playground-checkbox-hint",children:"Uses control plane API directly. Requires selecting an agent."}),e("label",{class:"playground-checkbox",children:[e("input",{type:"checkbox",checked:l.verbose,onChange:y=>u({...l,verbose:y.target.checked}),disabled:p}),e("span",{class:"playground-checkbox-label",children:"Verbose output"})]})]})]}),E&&e("div",{class:"playground-error",children:[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),E]})]}),e("div",{class:"playground-config-footer",children:e("button",{class:"btn btn-primary playground-execute-btn",onClick:W,disabled:!l.prompt.trim()||p,children:[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("polygon",{points:"5 3 19 12 5 21 5 3"})}),"Execute"]})})]}),e("div",{class:"card playground-output-panel",children:[e("div",{class:"playground-output-header",children:[e("div",{class:"playground-output-title",children:[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("polyline",{points:"4 17 10 11 4 5"}),e("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),"Output"]}),C&&e("code",{class:"playground-exec-id",children:C}),e("div",{style:{flex:1}}),p&&e("button",{class:"btn btn-danger playground-stop-btn",onClick:G,children:[e("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})}),"Stop"]}),!g&&!p&&e("button",{class:"btn btn-secondary",onClick:()=>I(!0),children:[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e("circle",{cx:"12",cy:"12",r:"3"})}),"Config"]})]}),e("div",{class:"playground-output-content",children:h.length===0&&!p?e("div",{class:"playground-empty-state",children:[e("div",{class:"playground-empty-icon",children:e(ke,{size:64})}),e("h3",{class:"playground-empty-title",children:"Ready to execute"}),e("p",{class:"playground-empty-text",children:"Configure your execution and press Execute to run"})]}):e(Vt,{events:h,isRunning:p,onClear:p?void 0:f})})]})]}),e("div",{class:"playground-stats",children:[e("div",{class:"playground-stat-card",children:[e("div",{class:"playground-stat-icon mode",children:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.mode==="auto"&&e(A,{children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 8v4l3 3"})]}),l.mode==="agent"&&e(A,{children:e("path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"})}),l.mode==="team"&&e(A,{children:[e("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e("circle",{cx:"9",cy:"7",r:"4"})]})]})}),e("div",{class:"playground-stat-info",children:[e("span",{class:"playground-stat-label",children:"Mode"}),e("span",{class:"playground-stat-value",children:l.mode})]})]}),e("div",{class:"playground-stat-card",children:[e("div",{class:`playground-stat-icon ${l.local?"local":"remote"}`,children:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.local?e(A,{children:[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}):e("path",{d:"M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"})})}),e("div",{class:"playground-stat-info",children:[e("span",{class:"playground-stat-label",children:"Location"}),e("span",{class:"playground-stat-value",children:l.local?"Local":"Remote"})]})]}),e("div",{class:"playground-stat-card",children:[e("div",{class:"playground-stat-icon events",children:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e("path",{d:"M3 3v18h18"}),e("path",{d:"M18 17V9"}),e("path",{d:"M13 17V5"}),e("path",{d:"M8 17v-3"})]})}),e("div",{class:"playground-stat-info",children:[e("span",{class:"playground-stat-label",children:"Events"}),e("span",{class:"playground-stat-value",children:h.length})]})]}),e("div",{class:"playground-stat-card",children:[e("div",{class:`playground-stat-icon status ${p?"running":h.length>0?"complete":"ready"}`,children:p?e("span",{class:"spinner",style:{width:14,height:14}}):e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:h.length>0?e(A,{children:[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})]}):e(A,{children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})]})})}),e("div",{class:"playground-stat-info",children:[e("span",{class:"playground-stat-label",children:"Status"}),e("span",{class:"playground-stat-value",children:p?"Running":h.length>0?"Complete":"Ready"})]})]})]})]})}var Ar={success:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e("polyline",{points:"20 6 9 17 4 12"})}),error:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),warning:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),info:e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})},Wr=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});function Fr({toast:t,onClose:r}){let n=()=>{t.action?.onClick&&t.action.onClick(),r(t.id)};return e("div",{class:`toast toast-${t.type}`,role:"alert","aria-live":t.type==="error"?"assertive":"polite",children:[e("div",{class:"toast-icon",children:Ar[t.type]}),e("div",{class:"toast-content",children:[e("div",{class:"toast-title",children:t.title}),t.message&&e("div",{class:"toast-message",children:t.message}),t.action&&e("div",{class:"toast-action",children:e("button",{class:"toast-action-btn",onClick:n,children:t.action.label})})]}),e("button",{class:"toast-close",onClick:()=>r(t.id),"aria-label":"Dismiss notification",children:Wr})]})}function qt(){let{toasts:t,removeToast:r}=we();return t.length===0?null:e("div",{class:"toast-container","aria-label":"Notifications",children:t.map(n=>e(Fr,{toast:n,onClose:r},n.id))})}function Jt(){return e(Ne,{children:e(De,{children:[e(Br,{}),e(qt,{})]})})}function Br(){let{currentPage:t,setPage:r,connected:n,controlPlane:a,config:o,overview:s,workers:i,sessions:c,logs:l,activity:u}=He(),p=()=>{switch(t){case"overview":return e(Me,{state:{overview:s,workers:i,controlPlane:a,sessions:c,logs:l,activity:u,config:o,connected:n}});case"workers":return e(Wt,{workers:i});case"proxy":return e(Nt,{});case"models":return e(Ot,{});case"playground":return e(Ut,{});case"doctor":return e(Ht,{});case"environment":return e($t,{});case"control-plane":return e(Ft,{status:a});case"diagnostics":return e(Bt,{logs:l,config:o});case"sessions":return e(Dt,{sessions:c});default:return e(Me,{state:{overview:s,workers:i,controlPlane:a,sessions:c,logs:l,activity:u,config:o,connected:n}})}};return e(ot,{currentPage:t,onNavigate:r,connected:n,queueId:o?.queue_id,controlPlane:a,config:o,children:p()})}Pe(e(Jt,{}),document.getElementById("app"));
